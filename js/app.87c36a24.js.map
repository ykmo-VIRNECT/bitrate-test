{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/MediaStreamRecorder/MediaStreamRecorder.js","webpack:///./src/App.vue?a34e","webpack:///./src/components/BitRateTest.vue?b2f4","webpack:///./src/utils/IDBHelper.js","webpack:///src/components/BitRateTest.vue","webpack:///./src/components/BitRateTest.vue?050f","webpack:///./src/components/BitRateTest.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/components/BitRateTest.vue?dab0"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","MediaStreamRecorder","mediaStream","mediaRecorder","this","start","timeSlice","Recorder","MediaRecorder","MediaRecorderWrapper","IsChrome","IsOpera","IsEdge","mimeType","indexOf","WhammyRecorder","StereoAudioRecorder","GifRecorder","recorderType","blobs","self","ondataavailable","onstop","onStartedDrawingNonBlankFrames","mergeProps","clearOldRecordedFrames","stop","blob","disableLogs","console","log","error","warn","save","file","fileName","invokeSaveAsDialog","ConcatenateBlobs","type","concatenatedBlob","pause","resume","MultiStreamRecorder","arrayOfMediaStreams","options","MediaStream","mixer","getVideoTracks","tracks","forEach","stream","track","video","width","height","frameInterval","prop","MultiStreamsMixer","startDrawingFrames","previewStream","getMixedStream","callback","clearRecordedData","releaseStreams","addStreams","addStream","streams","Array","concat","appendStreams","resetVideoStreams","toString","videos","isStopDrawingFrames","canvas","document","createElement","context","getContext","style","body","documentElement","appendChild","useGainNode","AudioContext","webkitAudioContext","mozAudioContext","URL","webkitURL","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","webkitMediaStream","getTracks","kind","getAudioTracks","Storage","drawVideosToCanvas","videosLength","fullcanvas","remaining","HTMLVideoElement","drawImage","idx","setTimeout","x","y","left","top","onRender","mixedVideoStream","getMixedVideoStream","mixedAudioStream","getMixedAudioStream","addTrack","capturedStream","captureStream","mozCaptureStream","videoStream","AudioContextConstructor","audioContext","audioSources","gainNode","createGain","connect","destination","gain","audioTracksLength","audioSource","createMediaStreamSource","audioDestination","createMediaStreamDestination","getVideo","srcObject","src","createObjectURL","muted","volume","play","disconnect","source","clearRect","browserFakeUserAgent","that","global","userAgent","location","protocol","href","hash","screen","msSaveBlob","msSaveOrOpenBlob","opera","mergein","mergeto","e","fileExtension","split","splitted","fileFullName","Math","round","random","hyperlink","target","download","onclick","removeChild","evt","MouseEvent","view","bubbles","cancelable","dispatchEvent","revokeObjectURL","bytesToSize","bytes","k","sizes","parseInt","floor","pow","toPrecision","ObjectStore","isMediaRecorderCompatible","isOpera","isChrome","chrome","isFirefox","InstallTrigger","appVersion","verOffset","ix","nAgt","fullVersion","parseFloat","majorVersion","substring","isNaN","isMediaStreamActive","active","ended","__disableLogs","dontFireOnDataAvailableEvent","recorderHints","canRecordMimeType","ignoreMutedMedia","firedOnDataAvailableOnce","size","getNativeBlob","Blob","state","onerror","requestData","timeslice","looper","timeout","StereoAudioRecorderHelper","record","setInterval","clearTimeout","root","deviceSampleRate","sampleRate","scriptprocessornode","leftchannel","rightchannel","recording","recordingLength","isPCM","numChannels","audioChannels","interleave","leftChannel","rightChannel","Float32Array","inputIndex","index","mergeBuffers","channelBuffer","offset","lng","buffer","set","writeUTFBytes","string","setUint8","charCodeAt","convertoFloat32ToInt16","buf","Int16Array","isPaused","requestDataInvoked","internalLeftChannel","internalRightChannel","internalRecordingLength","leftBuffer","interleaved","rightBuffer","debug","ArrayBuffer","DataView","setUint32","setUint16","setInt16","audioInput","VolumeGainNode","AudioInput","bufferSize","createJavaScriptNode","createScriptProcessor","onaudioprocess","inputBuffer","getChannelData","right","WhammyRecorderHelper","videoWidth","clientWidth","videoHeight","clientHeight","isHTMLObject","cloneNode","lastTime","Date","getTime","whammy","Whammy","Video","speed","quality","drawFrames","frames","internalFrames","dropBlackFrames","compile","whammyBlob","isOnStartedDrawingNonBlankFramesInvoked","isStopDrawing","duration","paused","image","toDataURL","isBlankFrame","frame","_pixTolerance","_frameTolerance","localCanvas","matchPixCount","endPixCheck","maxPixCount","context2d","sampleColor","g","b","maxColorDifference","sqrt","pixTolerance","frameTolerance","Image","imageData","getImageData","pix","currentColor","colorDifference","_frames","_framesToCheck","resultFrames","checkUntilNotBlack","endCheckFrame","doNotCheckNext","f","GIFEncoder","doneRecording","now","gifBlob","Uint8Array","gifEncoder","bin","imageWidth","imageHeight","drawVideoFrame","time","lastAnimationFrame","requestAnimationFrame","undefined","lastFrameTime","addFrame","setRepeat","setDelay","frameRate","setQuality","cancelAnimationFrame","autoplay","WhammyVideo","processInWebWorker","_function","worker","Worker","whammyInWebWorker","ArrayToWebM","info","checkFrames","clusterMaxDuration","EBML","doubleToString","frameNumber","clusterTimecode","clusterFrames","clusterDuration","clusterCounter","cluster","getClusterData","generateEBML","map","webp","block","makeSimpleBlock","discardable","invisible","keyframe","lacing","trackNum","timecode","id","postMessage","numToBuffer","num","parts","reverse","strToBuffer","str","bitsToBuffer","bits","pad","join","substr","json","ebml","len","byteLength","zeroes","ceil","sizeToString","padded","flags","out","String","fromCharCode","parseWebP","riff","tmp","VP8","RIFF","WEBP","frameStart","getStrLength","unpadded","parseRIFF","chunks","Float64Array","webm","atob","add","test","webWorker","onmessage","event","buffers","readAsArrayBuffer","concatenateBuffers","reader","FileReader","onload","Uint16Array","lastOffset","reusableByteLength","define","_vm","_h","$createElement","_c","_self","attrs","staticRenderFns","_v","_s","resolution","status","recLib","blobCount","_e","staticClass","on","$event","setRecLib","directives","rawName","expression","$$selectedVal","filter","selected","val","_value","multiple","_l","option","domProps","bitrate","videoRecording","screenRecording","saveOpt","composing","timeSliceValue","stopMultiRecorder","sendMessage","toggleWorkerVideo","toggleWorkerSound","ref","staticStyle","cameraStream","toggleRemoteSound","workerVideoStatus","workerAudioStatus","remote1AudioStatus","remote2AudioStatus","remote3AudioStatus","db","Dexie","initIDB","version","stores","mediaChunk","addMediaChunk","uuid","chunkNumber","getMediaChunkArray","where","equals","toArray","IDBHelper","component","components","BitRateTest","Vue","config","productionTip","render","h","App","$mount"],"mappings":"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,GAAGR,EAAIgD,gCAC7/L,EAAkB,G,gICChBC,EAAK,IAAIC,OAAM,cAErB,SAASC,IACP7c,QAAQC,IAAI,QACZ0c,EAAGG,QAAQ,GAAGC,OAAO,CACnBC,WAAY,4CAEdhd,QAAQC,IAAI0c,G,SAGCM,E,sGAAf,WAA6BC,EAAMC,EAAa7c,EAAUR,GAA1D,iGACQ6c,EAAGK,WAAWrE,IAAI,CACtBuE,KAAMA,EACNC,YAAaA,EACb7c,SAAUA,EACVR,KAAMA,IALV,2C,iCASesd,E,gGAAf,WAAkCF,GAAlC,wFACEld,QAAQC,IAAIid,GADd,SAGeP,EAAGK,WACbK,MAAM,QACNC,OAAOJ,GACPK,UANL,mF,wBASA,IAAMC,EAAY,CAChBX,QAASA,EACTI,cAAeA,EACfG,mBAAoBA,GAGPI,I,iCCsHf,GACA,KADA,WAEA,OACA,mBACA,kBAEA,UAEA,QACA,cASA,iCAEA,oBACA,QACA,YACA,kBACA,kBAGA,qBACA,qBAEA,sBACA,sBAEA,sBACA,sBAEA,sBACA,sBAEA,mBACA,mBACA,mBAEA,cACA,mBACA,YACA,kBACA,UACA,WACA,cACA,YACA,YACA,mBACA,WACA,WACA,gBACA,CACA,uBACA,cAEA,CACA,uBACA,cAEA,CACA,wBACA,cAEA,CACA,0BACA,gBAGA,aACA,CACA,yBACA,YAEA,CACA,eACA,YAEA,CACA,0BACA,aAEA,CACA,gBACA,aAEA,CACA,+BACA,WAEA,CACA,+BACA,YAEA,CACA,6BACA,WAEA,CACA,+BACA,YAEA,CACA,oCACA,YAEA,CACA,gCACA,aAGA,aACA,CACA,eACA,cAEA,CACA,aACA,eAEA,CACA,qBACA,cAOA,YACA,gBAGA,OACA,YACA,QADA,SACA,KACA,qBAEA,UACA,WACA,eACA,gBACA,MACA,WACA,eACA,gBACA,MACA,WACA,gBACA,gBACA,MACA,YACA,gBACA,iBACA,MACA,QACA,8BAGA,eAGA,cACA,SACA,KADA,WACA,qKACA,YACA,wBAEA,GACA,SACA,UAEA,sCACA,kCACA,0BAEA,oCACA,qBAEA,0BACA,2CAGA,2DAnBA,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","file":"js/app.87c36a24.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/bitrate-test/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","'use strict';\n\n// Last time updated: 2017-08-31 4:03:22 AM UTC\n\n// __________________________\n// MediaStreamRecorder v1.3.4\n\n// Open-Sourced: https://github.com/streamproc/MediaStreamRecorder\n\n// --------------------------------------------------\n// Muaz Khan     - www.MuazKhan.com\n// MIT License   - www.WebRTC-Experiment.com/licence\n// --------------------------------------------------\n\n// ______________________\n// MediaStreamRecorder.js\n\nfunction MediaStreamRecorder(mediaStream) {\n    if (!mediaStream) {\n        throw 'MediaStream is mandatory.';\n    }\n\n    // void start(optional long timeSlice)\n    // timestamp to fire \"ondataavailable\"\n    this.start = function(timeSlice) {\n        var Recorder;\n\n        if (typeof MediaRecorder !== 'undefined') {\n            Recorder = MediaRecorderWrapper;\n        } else if (IsChrome || IsOpera || IsEdge) {\n            if (this.mimeType.indexOf('video') !== -1) {\n                Recorder = WhammyRecorder;\n            } else if (this.mimeType.indexOf('audio') !== -1) {\n                Recorder = StereoAudioRecorder;\n            }\n        }\n\n        // video recorder (in GIF format)\n        if (this.mimeType === 'image/gif') {\n            Recorder = GifRecorder;\n        }\n\n        // audio/wav is supported only via StereoAudioRecorder\n        // audio/pcm (int16) is supported only via StereoAudioRecorder\n        if (this.mimeType === 'audio/wav' || this.mimeType === 'audio/pcm') {\n            Recorder = StereoAudioRecorder;\n        }\n\n        // allows forcing StereoAudioRecorder.js on Edge/Firefox\n        if (this.recorderType) {\n            Recorder = this.recorderType;\n        }\n\n        mediaRecorder = new Recorder(mediaStream);\n        mediaRecorder.blobs = [];\n\n        var self = this;\n        mediaRecorder.ondataavailable = function(data) {\n            mediaRecorder.blobs.push(data);\n            self.ondataavailable(data);\n        };\n        mediaRecorder.onstop = this.onstop;\n        mediaRecorder.onStartedDrawingNonBlankFrames = this.onStartedDrawingNonBlankFrames;\n\n        // Merge all data-types except \"function\"\n        mediaRecorder = mergeProps(mediaRecorder, this);\n\n        mediaRecorder.start(timeSlice);\n    };\n\n    this.onStartedDrawingNonBlankFrames = function() {};\n    this.clearOldRecordedFrames = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        mediaRecorder.clearOldRecordedFrames();\n    };\n\n    this.stop = function() {\n        if (mediaRecorder) {\n            mediaRecorder.stop();\n        }\n    };\n\n    this.ondataavailable = function(blob) {\n        if (this.disableLogs) return;\n        console.log('ondataavailable..', blob);\n    };\n\n    this.onstop = function(error) {\n        console.warn('stopped..', error);\n    };\n\n    this.save = function(file, fileName) {\n        if (!file) {\n            if (!mediaRecorder) {\n                return;\n            }\n\n            ConcatenateBlobs(mediaRecorder.blobs, mediaRecorder.blobs[0].type, function(concatenatedBlob) {\n                invokeSaveAsDialog(concatenatedBlob);\n            });\n            return;\n        }\n        invokeSaveAsDialog(file, fileName);\n    };\n\n    this.pause = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n        mediaRecorder.pause();\n\n        if (this.disableLogs) return;\n        console.log('Paused recording.', this.mimeType || mediaRecorder.mimeType);\n    };\n\n    this.resume = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n        mediaRecorder.resume();\n\n        if (this.disableLogs) return;\n        console.log('Resumed recording.', this.mimeType || mediaRecorder.mimeType);\n    };\n\n    // StereoAudioRecorder || WhammyRecorder || MediaRecorderWrapper || GifRecorder\n    this.recorderType = null;\n\n    // video/webm or audio/webm or audio/ogg or audio/wav\n    this.mimeType = 'video/webm';\n\n    // logs are enabled by default\n    this.disableLogs = false;\n\n    // Reference to \"MediaRecorder.js\"\n    var mediaRecorder;\n}\n\n// ______________________\n// MultiStreamRecorder.js\n\nfunction MultiStreamRecorder(arrayOfMediaStreams, options) {\n    arrayOfMediaStreams = arrayOfMediaStreams || [];\n\n    if (arrayOfMediaStreams instanceof MediaStream) {\n        arrayOfMediaStreams = [arrayOfMediaStreams];\n    }\n\n    var self = this;\n\n    var mixer;\n    var mediaRecorder;\n\n    options = options || {\n        mimeType: 'video/webm',\n        video: {\n            width: 360,\n            height: 240\n        }\n    };\n\n    if (!options.frameInterval) {\n        options.frameInterval = 10;\n    }\n\n    if (!options.video) {\n        options.video = {};\n    }\n\n    if (!options.video.width) {\n        options.video.width = 360;\n    }\n\n    if (!options.video.height) {\n        options.video.height = 240;\n    }\n\n    this.start = function(timeSlice) {\n        // github/muaz-khan/MultiStreamsMixer\n        mixer = new MultiStreamsMixer(arrayOfMediaStreams);\n\n        if (getVideoTracks().length) {\n            mixer.frameInterval = options.frameInterval || 10;\n            mixer.width = options.video.width || 360;\n            mixer.height = options.video.height || 240;\n            mixer.startDrawingFrames();\n        }\n\n        if (typeof self.previewStream === 'function') {\n            self.previewStream(mixer.getMixedStream());\n        }\n\n        // record using MediaRecorder API\n        mediaRecorder = new MediaStreamRecorder(mixer.getMixedStream());\n\n        for (var prop in self) {\n            if (typeof self[prop] !== 'function') {\n                mediaRecorder[prop] = self[prop];\n            }\n        }\n\n        mediaRecorder.ondataavailable = function(blob) {\n            self.ondataavailable(blob);\n        };\n\n        mediaRecorder.onstop = self.onstop;\n\n        mediaRecorder.start(timeSlice);\n    };\n\n    function getVideoTracks() {\n        var tracks = [];\n        arrayOfMediaStreams.forEach(function(stream) {\n            stream.getVideoTracks().forEach(function(track) {\n                tracks.push(track);\n            });\n        });\n        return tracks;\n    }\n\n    this.stop = function(callback) {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        mediaRecorder.stop(function(blob) {\n            callback(blob);\n        });\n    };\n\n    this.pause = function() {\n        if (mediaRecorder) {\n            mediaRecorder.pause();\n        }\n    };\n\n    this.resume = function() {\n        if (mediaRecorder) {\n            mediaRecorder.resume();\n        }\n    };\n\n    this.clearRecordedData = function() {\n        if (mediaRecorder) {\n            mediaRecorder.clearRecordedData();\n            mediaRecorder = null;\n        }\n\n        if (mixer) {\n            mixer.releaseStreams();\n            mixer = null;\n        }\n    };\n\n    this.addStreams = this.addStream = function(streams) {\n        if (!streams) {\n            throw 'First parameter is required.';\n        }\n\n        if (!(streams instanceof Array)) {\n            streams = [streams];\n        }\n\n        arrayOfMediaStreams.concat(streams);\n\n        if (!mediaRecorder || !mixer) {\n            return;\n        }\n\n        mixer.appendStreams(streams);\n    };\n\n    this.resetVideoStreams = function(streams) {\n        if (!mixer) {\n            return;\n        }\n\n        if (streams && !(streams instanceof Array)) {\n            streams = [streams];\n        }\n\n        mixer.resetVideoStreams(streams);\n    };\n\n    this.ondataavailable = function(blob) {\n        if (self.disableLogs) {\n            return;\n        }\n\n        console.log('ondataavailable', blob);\n    };\n\n    this.onstop = function() {};\n\n    // for debugging\n    this.name = 'MultiStreamRecorder';\n    this.toString = function() {\n        return this.name;\n    };\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.MultiStreamRecorder = MultiStreamRecorder;\n}\n\n// Last time updated: 2017-08-31 2:56:12 AM UTC\n\n// ________________________\n// MultiStreamsMixer v1.0.2\n\n// Open-Sourced: https://github.com/muaz-khan/MultiStreamsMixer\n\n// --------------------------------------------------\n// Muaz Khan     - www.MuazKhan.com\n// MIT License   - www.WebRTC-Experiment.com/licence\n// --------------------------------------------------\n\nfunction MultiStreamsMixer(arrayOfMediaStreams) {\n\n    // requires: chrome://flags/#enable-experimental-web-platform-features\n\n    var videos = [];\n    var isStopDrawingFrames = false;\n\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    canvas.style = 'opacity:0;position:absolute;z-index:-1;top: -100000000;left:-1000000000; margin-top:-1000000000;margin-left:-1000000000;';\n    (document.body || document.documentElement).appendChild(canvas);\n\n    this.disableLogs = false;\n    this.frameInterval = 10;\n\n    this.width = 360;\n    this.height = 240;\n\n    // use gain node to prevent echo\n    this.useGainNode = true;\n\n    var self = this;\n\n    // _____________________________\n    // Cross-Browser-Declarations.js\n\n    // WebAudio API representer\n    var AudioContext = window.AudioContext;\n\n    if (typeof AudioContext === 'undefined') {\n        if (typeof webkitAudioContext !== 'undefined') {\n            /*global AudioContext:true */\n            AudioContext = webkitAudioContext;\n        }\n\n        if (typeof mozAudioContext !== 'undefined') {\n            /*global AudioContext:true */\n            AudioContext = mozAudioContext;\n        }\n    }\n\n    /*jshint -W079 */\n    var URL = window.URL;\n\n    if (typeof URL === 'undefined' && typeof webkitURL !== 'undefined') {\n        /*global URL:true */\n        URL = webkitURL;\n    }\n\n    if (typeof navigator !== 'undefined' && typeof navigator.getUserMedia === 'undefined') { // maybe window.navigator?\n        if (typeof navigator.webkitGetUserMedia !== 'undefined') {\n            navigator.getUserMedia = navigator.webkitGetUserMedia;\n        }\n\n        if (typeof navigator.mozGetUserMedia !== 'undefined') {\n            navigator.getUserMedia = navigator.mozGetUserMedia;\n        }\n    }\n\n    var MediaStream = window.MediaStream;\n\n    if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\n        MediaStream = webkitMediaStream;\n    }\n\n    /*global MediaStream:true */\n    if (typeof MediaStream !== 'undefined') {\n        if (!('getVideoTracks' in MediaStream.prototype)) {\n            MediaStream.prototype.getVideoTracks = function() {\n                if (!this.getTracks) {\n                    return [];\n                }\n\n                var tracks = [];\n                this.getTracks.forEach(function(track) {\n                    if (track.kind.toString().indexOf('video') !== -1) {\n                        tracks.push(track);\n                    }\n                });\n                return tracks;\n            };\n\n            MediaStream.prototype.getAudioTracks = function() {\n                if (!this.getTracks) {\n                    return [];\n                }\n\n                var tracks = [];\n                this.getTracks.forEach(function(track) {\n                    if (track.kind.toString().indexOf('audio') !== -1) {\n                        tracks.push(track);\n                    }\n                });\n                return tracks;\n            };\n        }\n\n        // override \"stop\" method for all browsers\n        if (typeof MediaStream.prototype.stop === 'undefined') {\n            MediaStream.prototype.stop = function() {\n                this.getTracks().forEach(function(track) {\n                    track.stop();\n                });\n            };\n        }\n    }\n\n    var Storage = {};\n\n    if (typeof AudioContext !== 'undefined') {\n        Storage.AudioContext = AudioContext;\n    } else if (typeof webkitAudioContext !== 'undefined') {\n        Storage.AudioContext = webkitAudioContext;\n    }\n\n    this.startDrawingFrames = function() {\n        drawVideosToCanvas();\n    };\n\n    function drawVideosToCanvas() {\n        if (isStopDrawingFrames) {\n            return;\n        }\n\n        var videosLength = videos.length;\n\n        var fullcanvas = false;\n        var remaining = [];\n        videos.forEach(function(video) {\n            if (!video.stream) {\n                video.stream = {};\n            }\n\n            if (video.stream.fullcanvas) {\n                fullcanvas = video;\n            } else {\n                remaining.push(video);\n            }\n        });\n\n        if (fullcanvas) {\n            canvas.width = fullcanvas.stream.width;\n            canvas.height = fullcanvas.stream.height;\n        } else if (remaining.length) {\n            canvas.width = videosLength > 1 ? remaining[0].width * 2 : remaining[0].width;\n            canvas.height = videosLength > 2 ? remaining[0].height * 2 : remaining[0].height;\n        } else {\n            canvas.width = self.width || 360;\n            canvas.height = self.height || 240;\n        }\n\n        if (fullcanvas && fullcanvas instanceof HTMLVideoElement) {\n            drawImage(fullcanvas);\n        }\n\n        remaining.forEach(function(video, idx) {\n            drawImage(video, idx);\n        });\n\n        setTimeout(drawVideosToCanvas, self.frameInterval);\n    }\n\n    function drawImage(video, idx) {\n        if (isStopDrawingFrames) {\n            return;\n        }\n\n        var x = 0;\n        var y = 0;\n        var width = video.width;\n        var height = video.height;\n\n        if (idx === 1) {\n            x = video.width;\n        }\n\n        if (idx === 2) {\n            y = video.height;\n        }\n\n        if (idx === 3) {\n            x = video.width;\n            y = video.height;\n        }\n\n        if (typeof video.stream.left !== 'undefined') {\n            x = video.stream.left;\n        }\n\n        if (typeof video.stream.top !== 'undefined') {\n            y = video.stream.top;\n        }\n\n        if (typeof video.stream.width !== 'undefined') {\n            width = video.stream.width;\n        }\n\n        if (typeof video.stream.height !== 'undefined') {\n            height = video.stream.height;\n        }\n\n        context.drawImage(video, x, y, width, height);\n\n        if (typeof video.stream.onRender === 'function') {\n            video.stream.onRender(context, x, y, width, height, idx);\n        }\n    }\n\n    function getMixedStream() {\n        isStopDrawingFrames = false;\n        var mixedVideoStream = getMixedVideoStream();\n\n        var mixedAudioStream = getMixedAudioStream();\n        if (mixedAudioStream) {\n            mixedAudioStream.getAudioTracks().forEach(function(track) {\n                mixedVideoStream.addTrack(track);\n            });\n        }\n\n        var fullcanvas;\n        arrayOfMediaStreams.forEach(function(stream) {\n            if (stream.fullcanvas) {\n                fullcanvas = true;\n            }\n        });\n\n        return mixedVideoStream;\n    }\n\n    function getMixedVideoStream() {\n        resetVideoStreams();\n\n        var capturedStream;\n\n        if ('captureStream' in canvas) {\n            capturedStream = canvas.captureStream();\n        } else if ('mozCaptureStream' in canvas) {\n            capturedStream = canvas.mozCaptureStream();\n        } else if (!self.disableLogs) {\n            console.error('Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features');\n        }\n\n        var videoStream = new MediaStream();\n\n        capturedStream.getVideoTracks().forEach(function(track) {\n            videoStream.addTrack(track);\n        });\n\n        canvas.stream = videoStream;\n\n        return videoStream;\n    }\n\n    function getMixedAudioStream() {\n        // via: @pehrsons\n        if (!Storage.AudioContextConstructor) {\n            Storage.AudioContextConstructor = new Storage.AudioContext();\n        }\n\n        self.audioContext = Storage.AudioContextConstructor;\n\n        self.audioSources = [];\n\n        if (self.useGainNode === true) {\n            self.gainNode = self.audioContext.createGain();\n            self.gainNode.connect(self.audioContext.destination);\n            self.gainNode.gain.value = 0; // don't hear self\n        }\n\n        var audioTracksLength = 0;\n        arrayOfMediaStreams.forEach(function(stream) {\n            if (!stream.getAudioTracks().length) {\n                return;\n            }\n\n            audioTracksLength++;\n\n            var audioSource = self.audioContext.createMediaStreamSource(stream);\n\n            if (self.useGainNode === true) {\n                audioSource.connect(self.gainNode);\n            }\n\n            self.audioSources.push(audioSource);\n        });\n\n        if (!audioTracksLength) {\n            return;\n        }\n\n        self.audioDestination = self.audioContext.createMediaStreamDestination();\n        self.audioSources.forEach(function(audioSource) {\n            audioSource.connect(self.audioDestination);\n        });\n        return self.audioDestination.stream;\n    }\n\n    function getVideo(stream) {\n        var video = document.createElement('video');\n\n        if ('srcObject' in video) {\n            video.srcObject = stream;\n        } else {\n            video.src = URL.createObjectURL(stream);\n        }\n\n        video.muted = true;\n        video.volume = 0;\n\n        video.width = stream.width || self.width || 360;\n        video.height = stream.height || self.height || 240;\n\n        video.play();\n\n        return video;\n    }\n\n    this.appendStreams = function(streams) {\n        if (!streams) {\n            throw 'First parameter is required.';\n        }\n\n        if (!(streams instanceof Array)) {\n            streams = [streams];\n        }\n\n        arrayOfMediaStreams.concat(streams);\n\n        streams.forEach(function(stream) {\n            if (stream.getVideoTracks().length) {\n                var video = getVideo(stream);\n                video.stream = stream;\n                videos.push(video);\n            }\n\n            if (stream.getAudioTracks().length && self.audioContext) {\n                var audioSource = self.audioContext.createMediaStreamSource(stream);\n                audioSource.connect(self.audioDestination);\n                self.audioSources.push(audioSource);\n            }\n        });\n    };\n\n    this.releaseStreams = function() {\n        videos = [];\n        isStopDrawingFrames = true;\n\n        if (self.gainNode) {\n            self.gainNode.disconnect();\n            self.gainNode = null;\n        }\n\n        if (self.audioSources.length) {\n            self.audioSources.forEach(function(source) {\n                source.disconnect();\n            });\n            self.audioSources = [];\n        }\n\n        if (self.audioDestination) {\n            self.audioDestination.disconnect();\n            self.audioDestination = null;\n        }\n\n        self.audioContext = null;\n\n        context.clearRect(0, 0, canvas.width, canvas.height);\n\n        if (canvas.stream) {\n            canvas.stream.stop();\n            canvas.stream = null;\n        }\n    };\n\n    this.resetVideoStreams = function(streams) {\n        if (streams && !(streams instanceof Array)) {\n            streams = [streams];\n        }\n\n        resetVideoStreams(streams);\n    };\n\n    function resetVideoStreams(streams) {\n        videos = [];\n        streams = streams || arrayOfMediaStreams;\n\n        // via: @adrian-ber\n        streams.forEach(function(stream) {\n            if (!stream.getVideoTracks().length) {\n                return;\n            }\n\n            var video = getVideo(stream);\n            video.stream = stream;\n            videos.push(video);\n        });\n    }\n\n    // for debugging\n    this.name = 'MultiStreamsMixer';\n    this.toString = function() {\n        return this.name;\n    };\n\n    this.getMixedStream = getMixedStream;\n\n}\n\n// _____________________________\n// Cross-Browser-Declarations.js\n\nvar browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\n\n(function(that) {\n    if (typeof window !== 'undefined') {\n        return;\n    }\n\n    if (typeof window === 'undefined' && typeof global !== 'undefined') {\n        global.navigator = {\n            userAgent: browserFakeUserAgent,\n            getUserMedia: function() {}\n        };\n\n        /*global window:true */\n        that.window = global;\n    } else if (typeof window === 'undefined') {\n        // window = this;\n    }\n\n    if (typeof document === 'undefined') {\n        /*global document:true */\n        that.document = {};\n\n        document.createElement = document.captureStream = document.mozCaptureStream = function() {\n            return {};\n        };\n    }\n\n    if (typeof location === 'undefined') {\n        /*global location:true */\n        that.location = {\n            protocol: 'file:',\n            href: '',\n            hash: ''\n        };\n    }\n\n    if (typeof screen === 'undefined') {\n        /*global screen:true */\n        that.screen = {\n            width: 0,\n            height: 0\n        };\n    }\n})(typeof global !== 'undefined' ? global : window);\n\n// WebAudio API representer\nvar AudioContext = window.AudioContext;\n\nif (typeof AudioContext === 'undefined') {\n    if (typeof webkitAudioContext !== 'undefined') {\n        /*global AudioContext:true */\n        AudioContext = webkitAudioContext;\n    }\n\n    if (typeof mozAudioContext !== 'undefined') {\n        /*global AudioContext:true */\n        AudioContext = mozAudioContext;\n    }\n}\n\nif (typeof window === 'undefined') {\n    /*jshint -W020 */\n    window = {};\n}\n\n// WebAudio API representer\nvar AudioContext = window.AudioContext;\n\nif (typeof AudioContext === 'undefined') {\n    if (typeof webkitAudioContext !== 'undefined') {\n        /*global AudioContext:true */\n        AudioContext = webkitAudioContext;\n    }\n\n    if (typeof mozAudioContext !== 'undefined') {\n        /*global AudioContext:true */\n        AudioContext = mozAudioContext;\n    }\n}\n\n/*jshint -W079 */\nvar URL = window.URL;\n\nif (typeof URL === 'undefined' && typeof webkitURL !== 'undefined') {\n    /*global URL:true */\n    URL = webkitURL;\n}\n\nif (typeof navigator !== 'undefined') {\n    if (typeof navigator.webkitGetUserMedia !== 'undefined') {\n        navigator.getUserMedia = navigator.webkitGetUserMedia;\n    }\n\n    if (typeof navigator.mozGetUserMedia !== 'undefined') {\n        navigator.getUserMedia = navigator.mozGetUserMedia;\n    }\n} else {\n    navigator = {\n        getUserMedia: function() {},\n        userAgent: browserFakeUserAgent\n    };\n}\n\nvar IsEdge = navigator.userAgent.indexOf('Edge') !== -1 && (!!navigator.msSaveBlob || !!navigator.msSaveOrOpenBlob);\n\nvar IsOpera = false;\nif (typeof opera !== 'undefined' && navigator.userAgent && navigator.userAgent.indexOf('OPR/') !== -1) {\n    IsOpera = true;\n}\nvar IsChrome = !IsEdge && !IsEdge && !!navigator.webkitGetUserMedia;\n\nvar MediaStream = window.MediaStream;\n\nif (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\n    MediaStream = webkitMediaStream;\n}\n\n/*global MediaStream:true */\nif (typeof MediaStream !== 'undefined') {\n    if (!('getVideoTracks' in MediaStream.prototype)) {\n        MediaStream.prototype.getVideoTracks = function() {\n            if (!this.getTracks) {\n                return [];\n            }\n\n            var tracks = [];\n            this.getTracks.forEach(function(track) {\n                if (track.kind.toString().indexOf('video') !== -1) {\n                    tracks.push(track);\n                }\n            });\n            return tracks;\n        };\n\n        MediaStream.prototype.getAudioTracks = function() {\n            if (!this.getTracks) {\n                return [];\n            }\n\n            var tracks = [];\n            this.getTracks.forEach(function(track) {\n                if (track.kind.toString().indexOf('audio') !== -1) {\n                    tracks.push(track);\n                }\n            });\n            return tracks;\n        };\n    }\n\n    if (!('stop' in MediaStream.prototype)) {\n        MediaStream.prototype.stop = function() {\n            this.getAudioTracks().forEach(function(track) {\n                if (!!track.stop) {\n                    track.stop();\n                }\n            });\n\n            this.getVideoTracks().forEach(function(track) {\n                if (!!track.stop) {\n                    track.stop();\n                }\n            });\n        };\n    }\n}\n\nif (typeof location !== 'undefined') {\n    if (location.href.indexOf('file:') === 0) {\n        console.error('Please load this HTML file on HTTP or HTTPS.');\n    }\n}\n\n// Merge all other data-types except \"function\"\n\nfunction mergeProps(mergein, mergeto) {\n    for (var t in mergeto) {\n        if (typeof mergeto[t] !== 'function') {\n            mergein[t] = mergeto[t];\n        }\n    }\n    return mergein;\n}\n\n// \"dropFirstFrame\" has been added by Graham Roth\n// https://github.com/gsroth\n\nfunction dropFirstFrame(arr) {\n    arr.shift();\n    return arr;\n}\n\n/**\n * @param {Blob} file - File or Blob object. This parameter is required.\n * @param {string} fileName - Optional file name e.g. \"Recorded-Video.webm\"\n * @example\n * invokeSaveAsDialog(blob or file, [optional] fileName);\n * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}\n */\nfunction invokeSaveAsDialog(file, fileName) {\n    if (!file) {\n        throw 'Blob object is required.';\n    }\n\n    if (!file.type) {\n        try {\n            file.type = 'video/webm';\n        } catch (e) {}\n    }\n\n    var fileExtension = (file.type || 'video/webm').split('/')[1];\n\n    if (fileName && fileName.indexOf('.') !== -1) {\n        var splitted = fileName.split('.');\n        fileName = splitted[0];\n        fileExtension = splitted[1];\n    }\n\n    var fileFullName = (fileName || (Math.round(Math.random() * 9999999999) + 888888888)) + '.' + fileExtension;\n\n    if (typeof navigator.msSaveOrOpenBlob !== 'undefined') {\n        return navigator.msSaveOrOpenBlob(file, fileFullName);\n    } else if (typeof navigator.msSaveBlob !== 'undefined') {\n        return navigator.msSaveBlob(file, fileFullName);\n    }\n\n    var hyperlink = document.createElement('a');\n    hyperlink.href = URL.createObjectURL(file);\n    hyperlink.target = '_blank';\n    hyperlink.download = fileFullName;\n\n    if (!!navigator.mozGetUserMedia) {\n        hyperlink.onclick = function() {\n            (document.body || document.documentElement).removeChild(hyperlink);\n        };\n        (document.body || document.documentElement).appendChild(hyperlink);\n    }\n\n    var evt = new MouseEvent('click', {\n        view: window,\n        bubbles: true,\n        cancelable: true\n    });\n\n    hyperlink.dispatchEvent(evt);\n\n    if (!navigator.mozGetUserMedia) {\n        URL.revokeObjectURL(hyperlink.href);\n    }\n}\n\nfunction bytesToSize(bytes) {\n    var k = 1000;\n    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n    if (bytes === 0) {\n        return '0 Bytes';\n    }\n    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10);\n    return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];\n}\n\n// ______________ (used to handle stuff like http://goo.gl/xmE5eg) issue #129\n// ObjectStore.js\nvar ObjectStore = {\n    AudioContext: AudioContext\n};\n\nfunction isMediaRecorderCompatible() {\n    var isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;\n    var isChrome = !!window.chrome && !isOpera;\n    var isFirefox = typeof window.InstallTrigger !== 'undefined';\n\n    if (isFirefox) {\n        return true;\n    }\n\n    if (!isChrome) {\n        return false;\n    }\n\n    var nVer = navigator.appVersion;\n    var nAgt = navigator.userAgent;\n    var fullVersion = '' + parseFloat(navigator.appVersion);\n    var majorVersion = parseInt(navigator.appVersion, 10);\n    var nameOffset, verOffset, ix;\n\n    if (isChrome) {\n        verOffset = nAgt.indexOf('Chrome');\n        fullVersion = nAgt.substring(verOffset + 7);\n    }\n\n    // trim the fullVersion string at semicolon/space if present\n    if ((ix = fullVersion.indexOf(';')) !== -1) {\n        fullVersion = fullVersion.substring(0, ix);\n    }\n\n    if ((ix = fullVersion.indexOf(' ')) !== -1) {\n        fullVersion = fullVersion.substring(0, ix);\n    }\n\n    majorVersion = parseInt('' + fullVersion, 10);\n\n    if (isNaN(majorVersion)) {\n        fullVersion = '' + parseFloat(navigator.appVersion);\n        majorVersion = parseInt(navigator.appVersion, 10);\n    }\n\n    return majorVersion >= 49;\n}\n\n// ==================\n// MediaRecorder.js\n\n/**\n * Implementation of https://dvcs.w3.org/hg/dap/raw-file/default/media-stream-capture/MediaRecorder.html\n * The MediaRecorder accepts a mediaStream as input source passed from UA. When recorder starts,\n * a MediaEncoder will be created and accept the mediaStream as input source.\n * Encoder will get the raw data by track data changes, encode it by selected MIME Type, then store the encoded in EncodedBufferCache object.\n * The encoded data will be extracted on every timeslice passed from Start function call or by RequestData function.\n * Thread model:\n * When the recorder starts, it creates a \"Media Encoder\" thread to read data from MediaEncoder object and store buffer in EncodedBufferCache object.\n * Also extract the encoded data and create blobs on every timeslice passed from start function or RequestData function called by UA.\n */\n\nfunction MediaRecorderWrapper(mediaStream) {\n    var self = this;\n\n    /**\n     * This method records MediaStream.\n     * @method\n     * @memberof MediaStreamRecorder\n     * @example\n     * recorder.start(5000);\n     */\n    this.start = function(timeSlice, __disableLogs) {\n        this.timeSlice = timeSlice || 5000;\n\n        if (!self.mimeType) {\n            self.mimeType = 'video/webm';\n        }\n\n        if (self.mimeType.indexOf('audio') !== -1) {\n            if (mediaStream.getVideoTracks().length && mediaStream.getAudioTracks().length) {\n                var stream;\n                if (!!navigator.mozGetUserMedia) {\n                    stream = new MediaStream();\n                    stream.addTrack(mediaStream.getAudioTracks()[0]);\n                } else {\n                    // webkitMediaStream\n                    stream = new MediaStream(mediaStream.getAudioTracks());\n                }\n                mediaStream = stream;\n            }\n        }\n\n        if (self.mimeType.indexOf('audio') !== -1) {\n            self.mimeType = IsChrome ? 'audio/webm' : 'audio/ogg';\n        }\n\n        self.dontFireOnDataAvailableEvent = false;\n\n        var recorderHints = {\n            mimeType: self.mimeType\n        };\n\n        if (!self.disableLogs && !__disableLogs) {\n            console.log('Passing following params over MediaRecorder API.', recorderHints);\n        }\n\n        if (mediaRecorder) {\n            // mandatory to make sure Firefox doesn't fails to record streams 3-4 times without reloading the page.\n            mediaRecorder = null;\n        }\n\n        if (IsChrome && !isMediaRecorderCompatible()) {\n            // to support video-only recording on stable\n            recorderHints = 'video/vp8';\n        }\n\n        // http://dxr.mozilla.org/mozilla-central/source/content/media/MediaRecorder.cpp\n        // https://wiki.mozilla.org/Gecko:MediaRecorder\n        // https://dvcs.w3.org/hg/dap/raw-file/default/media-stream-capture/MediaRecorder.html\n\n        // starting a recording session; which will initiate \"Reading Thread\"\n        // \"Reading Thread\" are used to prevent main-thread blocking scenarios\n        try {\n            mediaRecorder = new MediaRecorder(mediaStream, recorderHints);\n        } catch (e) {\n            // if someone passed NON_supported mimeType\n            // or if Firefox on Android\n            mediaRecorder = new MediaRecorder(mediaStream);\n        }\n\n        if ('canRecordMimeType' in mediaRecorder && mediaRecorder.canRecordMimeType(self.mimeType) === false) {\n            if (!self.disableLogs) {\n                console.warn('MediaRecorder API seems unable to record mimeType:', self.mimeType);\n            }\n        }\n\n        // i.e. stop recording when <video> is paused by the user; and auto restart recording \n        // when video is resumed. E.g. yourStream.getVideoTracks()[0].muted = true; // it will auto-stop recording.\n        if (self.ignoreMutedMedia === true) {\n            mediaRecorder.ignoreMutedMedia = true;\n        }\n\n        var firedOnDataAvailableOnce = false;\n\n        // Dispatching OnDataAvailable Handler\n        mediaRecorder.ondataavailable = function(e) {\n            // how to fix FF-corrupt-webm issues?\n            // should we leave this?          e.data.size < 26800\n            if (!e.data || !e.data.size || e.data.size < 26800 || firedOnDataAvailableOnce) {\n                return;\n            }\n\n            firedOnDataAvailableOnce = true;\n\n            var blob = self.getNativeBlob ? e.data : new Blob([e.data], {\n                type: self.mimeType || 'video/webm'\n            });\n\n            self.ondataavailable(blob);\n\n            // self.dontFireOnDataAvailableEvent = true;\n\n            if (!!mediaRecorder && mediaRecorder.state === 'recording') {\n                mediaRecorder.stop();\n            }\n            mediaRecorder = null;\n\n            if (self.dontFireOnDataAvailableEvent) {\n                return;\n            }\n\n            // record next interval\n            self.start(timeSlice, '__disableLogs');\n        };\n\n        mediaRecorder.onerror = function(error) {\n            if (!self.disableLogs) {\n                if (error.name === 'InvalidState') {\n                    console.error('The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.');\n                } else if (error.name === 'OutOfMemory') {\n                    console.error('The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.');\n                } else if (error.name === 'IllegalStreamModification') {\n                    console.error('A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.');\n                } else if (error.name === 'OtherRecordingError') {\n                    console.error('Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.');\n                } else if (error.name === 'GenericError') {\n                    console.error('The UA cannot provide the codec or recording option that has been requested.', error);\n                } else {\n                    console.error('MediaRecorder Error', error);\n                }\n            }\n\n            // When the stream is \"ended\" set recording to 'inactive' \n            // and stop gathering data. Callers should not rely on \n            // exactness of the timeSlice value, especially \n            // if the timeSlice value is small. Callers should \n            // consider timeSlice as a minimum value\n\n            if (!!mediaRecorder && mediaRecorder.state !== 'inactive' && mediaRecorder.state !== 'stopped') {\n                mediaRecorder.stop();\n            }\n        };\n\n        // void start(optional long mTimeSlice)\n        // The interval of passing encoded data from EncodedBufferCache to onDataAvailable\n        // handler. \"mTimeSlice < 0\" means Session object does not push encoded data to\n        // onDataAvailable, instead, it passive wait the client side pull encoded data\n        // by calling requestData API.\n        try {\n            mediaRecorder.start(3.6e+6);\n        } catch (e) {\n            mediaRecorder = null;\n        }\n\n        setTimeout(function() {\n            if (!mediaRecorder) {\n                return;\n            }\n\n            if (mediaRecorder.state === 'recording') {\n                // \"stop\" method auto invokes \"requestData\"!\n                mediaRecorder.requestData();\n                // mediaRecorder.stop();\n            }\n        }, timeSlice);\n\n        // Start recording. If timeSlice has been provided, mediaRecorder will\n        // raise a dataavailable event containing the Blob of collected data on every timeSlice milliseconds.\n        // If timeSlice isn't provided, UA should call the RequestData to obtain the Blob data, also set the mTimeSlice to zero.\n    };\n\n    /**\n     * This method stops recording MediaStream.\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\n     * @method\n     * @memberof MediaStreamRecorder\n     * @example\n     * recorder.stop(function(blob) {\n     *     video.src = URL.createObjectURL(blob);\n     * });\n     */\n    this.stop = function(callback) {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        // mediaRecorder.state === 'recording' means that media recorder is associated with \"session\"\n        // mediaRecorder.state === 'stopped' means that media recorder is detached from the \"session\" ... in this case; \"session\" will also be deleted.\n\n        if (mediaRecorder.state === 'recording') {\n            // \"stop\" method auto invokes \"requestData\"!\n            mediaRecorder.requestData();\n\n            setTimeout(function() {\n                self.dontFireOnDataAvailableEvent = true;\n                if (!!mediaRecorder && mediaRecorder.state === 'recording') {\n                    mediaRecorder.stop();\n                }\n                mediaRecorder = null;\n                self.onstop();\n            }, 2000);\n        }\n    };\n\n    /**\n     * This method pauses the recording process.\n     * @method\n     * @memberof MediaStreamRecorder\n     * @example\n     * recorder.pause();\n     */\n    this.pause = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        if (mediaRecorder.state === 'recording') {\n            mediaRecorder.pause();\n        }\n\n        this.dontFireOnDataAvailableEvent = true;\n    };\n\n    /**\n     * The recorded blobs are passed over this event.\n     * @event\n     * @memberof MediaStreamRecorder\n     * @example\n     * recorder.ondataavailable = function(data) {};\n     */\n    this.ondataavailable = function(blob) {\n        console.log('recorded-blob', blob);\n    };\n\n    /**\n     * This method resumes the recording process.\n     * @method\n     * @memberof MediaStreamRecorder\n     * @example\n     * recorder.resume();\n     */\n    this.resume = function() {\n        if (this.dontFireOnDataAvailableEvent) {\n            this.dontFireOnDataAvailableEvent = false;\n\n            var disableLogs = self.disableLogs;\n            self.disableLogs = true;\n            this.start(this.timeslice || 5000);\n            self.disableLogs = disableLogs;\n            return;\n        }\n\n        if (!mediaRecorder) {\n            return;\n        }\n\n        if (mediaRecorder.state === 'paused') {\n            mediaRecorder.resume();\n        }\n    };\n\n    /**\n     * This method resets currently recorded data.\n     * @method\n     * @memberof MediaStreamRecorder\n     * @example\n     * recorder.clearRecordedData();\n     */\n    this.clearRecordedData = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        this.pause();\n\n        this.dontFireOnDataAvailableEvent = true;\n        this.stop();\n    };\n\n    this.onstop = function() {};\n\n    // Reference to \"MediaRecorder\" object\n    var mediaRecorder;\n\n    function isMediaStreamActive() {\n        if ('active' in mediaStream) {\n            if (!mediaStream.active) {\n                return false;\n            }\n        } else if ('ended' in mediaStream) { // old hack\n            if (mediaStream.ended) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    // this method checks if media stream is stopped\n    // or any track is ended.\n    (function looper() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        if (isMediaStreamActive() === false) {\n            self.stop();\n            return;\n        }\n\n        setTimeout(looper, 1000); // check every second\n    })();\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.MediaRecorderWrapper = MediaRecorderWrapper;\n}\n\n// ======================\n// StereoAudioRecorder.js\n\nfunction StereoAudioRecorder(mediaStream) {\n    // void start(optional long timeSlice)\n    // timestamp to fire \"ondataavailable\"\n    this.start = function(timeSlice) {\n        timeSlice = timeSlice || 1000;\n\n        mediaRecorder = new StereoAudioRecorderHelper(mediaStream, this);\n\n        mediaRecorder.record();\n\n        timeout = setInterval(function() {\n            mediaRecorder.requestData();\n        }, timeSlice);\n    };\n\n    this.stop = function() {\n        if (mediaRecorder) {\n            mediaRecorder.stop();\n            clearTimeout(timeout);\n            this.onstop();\n        }\n    };\n\n    this.pause = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        mediaRecorder.pause();\n    };\n\n    this.resume = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        mediaRecorder.resume();\n    };\n\n    this.ondataavailable = function() {};\n    this.onstop = function() {};\n\n    // Reference to \"StereoAudioRecorder\" object\n    var mediaRecorder;\n    var timeout;\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.StereoAudioRecorder = StereoAudioRecorder;\n}\n\n// ============================\n// StereoAudioRecorderHelper.js\n\n// source code from: http://typedarray.org/wp-content/projects/WebAudioRecorder/script.js\n\nfunction StereoAudioRecorderHelper(mediaStream, root) {\n\n    // variables    \n    var deviceSampleRate = 44100; // range: 22050 to 96000\n\n    if (!ObjectStore.AudioContextConstructor) {\n        ObjectStore.AudioContextConstructor = new ObjectStore.AudioContext();\n    }\n\n    // check device sample rate\n    deviceSampleRate = ObjectStore.AudioContextConstructor.sampleRate;\n\n    var leftchannel = [];\n    var rightchannel = [];\n    var scriptprocessornode;\n    var recording = false;\n    var recordingLength = 0;\n    var volume;\n    var audioInput;\n    var sampleRate = root.sampleRate || deviceSampleRate;\n\n    var mimeType = root.mimeType || 'audio/wav';\n    var isPCM = mimeType.indexOf('audio/pcm') > -1;\n\n    var context;\n\n    var numChannels = root.audioChannels || 2;\n\n    this.record = function() {\n        recording = true;\n        // reset the buffers for the new recording\n        leftchannel.length = rightchannel.length = 0;\n        recordingLength = 0;\n    };\n\n    this.requestData = function() {\n        if (isPaused) {\n            return;\n        }\n\n        if (recordingLength === 0) {\n            requestDataInvoked = false;\n            return;\n        }\n\n        requestDataInvoked = true;\n        // clone stuff\n        var internalLeftChannel = leftchannel.slice(0);\n        var internalRightChannel = rightchannel.slice(0);\n        var internalRecordingLength = recordingLength;\n\n        // reset the buffers for the new recording\n        leftchannel.length = rightchannel.length = [];\n        recordingLength = 0;\n        requestDataInvoked = false;\n\n        // we flat the left and right channels down\n        var leftBuffer = mergeBuffers(internalLeftChannel, internalRecordingLength);\n\n        var interleaved = leftBuffer;\n\n        // we interleave both channels together\n        if (numChannels === 2) {\n            var rightBuffer = mergeBuffers(internalRightChannel, internalRecordingLength); // bug fixed via #70,#71\n            interleaved = interleave(leftBuffer, rightBuffer);\n        }\n\n        if (isPCM) {\n            // our final binary blob\n            var blob = new Blob([convertoFloat32ToInt16(interleaved)], {\n                type: 'audio/pcm'\n            });\n\n            console.debug('audio recorded blob size:', bytesToSize(blob.size));\n            root.ondataavailable(blob);\n            return;\n        }\n\n        // we create our wav file\n        var buffer = new ArrayBuffer(44 + interleaved.length * 2);\n        var view = new DataView(buffer);\n\n        // RIFF chunk descriptor\n        writeUTFBytes(view, 0, 'RIFF');\n\n        // -8 (via #97)\n        view.setUint32(4, 44 + interleaved.length * 2 - 8, true);\n\n        writeUTFBytes(view, 8, 'WAVE');\n        // FMT sub-chunk\n        writeUTFBytes(view, 12, 'fmt ');\n        view.setUint32(16, 16, true);\n        view.setUint16(20, 1, true);\n        // stereo (2 channels)\n        view.setUint16(22, numChannels, true);\n        view.setUint32(24, sampleRate, true);\n        view.setUint32(28, sampleRate * numChannels * 2, true); // numChannels * 2 (via #71)\n        view.setUint16(32, numChannels * 2, true);\n        view.setUint16(34, 16, true);\n        // data sub-chunk\n        writeUTFBytes(view, 36, 'data');\n        view.setUint32(40, interleaved.length * 2, true);\n\n        // write the PCM samples\n        var lng = interleaved.length;\n        var index = 44;\n        var volume = 1;\n        for (var i = 0; i < lng; i++) {\n            view.setInt16(index, interleaved[i] * (0x7FFF * volume), true);\n            index += 2;\n        }\n\n        // our final binary blob\n        var blob = new Blob([view], {\n            type: 'audio/wav'\n        });\n\n        console.debug('audio recorded blob size:', bytesToSize(blob.size));\n\n        root.ondataavailable(blob);\n    };\n\n    this.stop = function() {\n        // we stop recording\n        recording = false;\n        this.requestData();\n\n        audioInput.disconnect();\n        this.onstop();\n    };\n\n    function interleave(leftChannel, rightChannel) {\n        var length = leftChannel.length + rightChannel.length;\n        var result = new Float32Array(length);\n\n        var inputIndex = 0;\n\n        for (var index = 0; index < length;) {\n            result[index++] = leftChannel[inputIndex];\n            result[index++] = rightChannel[inputIndex];\n            inputIndex++;\n        }\n        return result;\n    }\n\n    function mergeBuffers(channelBuffer, recordingLength) {\n        var result = new Float32Array(recordingLength);\n        var offset = 0;\n        var lng = channelBuffer.length;\n        for (var i = 0; i < lng; i++) {\n            var buffer = channelBuffer[i];\n            result.set(buffer, offset);\n            offset += buffer.length;\n        }\n        return result;\n    }\n\n    function writeUTFBytes(view, offset, string) {\n        var lng = string.length;\n        for (var i = 0; i < lng; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n\n    function convertoFloat32ToInt16(buffer) {\n        var l = buffer.length;\n        var buf = new Int16Array(l)\n\n        while (l--) {\n            buf[l] = buffer[l] * 0xFFFF; //convert to 16 bit\n        }\n        return buf.buffer\n    }\n\n    // creates the audio context\n    var context = ObjectStore.AudioContextConstructor;\n\n    // creates a gain node\n    ObjectStore.VolumeGainNode = context.createGain();\n\n    var volume = ObjectStore.VolumeGainNode;\n\n    // creates an audio node from the microphone incoming stream\n    ObjectStore.AudioInput = context.createMediaStreamSource(mediaStream);\n\n    // creates an audio node from the microphone incoming stream\n    var audioInput = ObjectStore.AudioInput;\n\n    // connect the stream to the gain node\n    audioInput.connect(volume);\n\n    /* From the spec: This value controls how frequently the audioprocess event is\n    dispatched and how many sample-frames need to be processed each call.\n    Lower values for buffer size will result in a lower (better) latency.\n    Higher values will be necessary to avoid audio breakup and glitches \n    Legal values are 256, 512, 1024, 2048, 4096, 8192, and 16384.*/\n    var bufferSize = root.bufferSize || 2048;\n    if (root.bufferSize === 0) {\n        bufferSize = 0;\n    }\n\n    if (context.createJavaScriptNode) {\n        scriptprocessornode = context.createJavaScriptNode(bufferSize, numChannels, numChannels);\n    } else if (context.createScriptProcessor) {\n        scriptprocessornode = context.createScriptProcessor(bufferSize, numChannels, numChannels);\n    } else {\n        throw 'WebAudio API has no support on this browser.';\n    }\n\n    bufferSize = scriptprocessornode.bufferSize;\n\n    console.debug('using audio buffer-size:', bufferSize);\n\n    var requestDataInvoked = false;\n\n    // sometimes \"scriptprocessornode\" disconnects from he destination-node\n    // and there is no exception thrown in this case.\n    // and obviously no further \"ondataavailable\" events will be emitted.\n    // below global-scope variable is added to debug such unexpected but \"rare\" cases.\n    window.scriptprocessornode = scriptprocessornode;\n\n    if (numChannels === 1) {\n        console.debug('All right-channels are skipped.');\n    }\n\n    var isPaused = false;\n\n    this.pause = function() {\n        isPaused = true;\n    };\n\n    this.resume = function() {\n        isPaused = false;\n    };\n\n    this.onstop = function() {};\n\n    // http://webaudio.github.io/web-audio-api/#the-scriptprocessornode-interface\n    scriptprocessornode.onaudioprocess = function(e) {\n        if (!recording || requestDataInvoked || isPaused) {\n            return;\n        }\n\n        var left = e.inputBuffer.getChannelData(0);\n        leftchannel.push(new Float32Array(left));\n\n        if (numChannels === 2) {\n            var right = e.inputBuffer.getChannelData(1);\n            rightchannel.push(new Float32Array(right));\n        }\n        recordingLength += bufferSize;\n    };\n\n    volume.connect(scriptprocessornode);\n    scriptprocessornode.connect(context.destination);\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.StereoAudioRecorderHelper = StereoAudioRecorderHelper;\n}\n\n// ===================\n// WhammyRecorder.js\n\nfunction WhammyRecorder(mediaStream) {\n    // void start(optional long timeSlice)\n    // timestamp to fire \"ondataavailable\"\n    this.start = function(timeSlice) {\n        timeSlice = timeSlice || 1000;\n\n        mediaRecorder = new WhammyRecorderHelper(mediaStream, this);\n\n        for (var prop in this) {\n            if (typeof this[prop] !== 'function') {\n                mediaRecorder[prop] = this[prop];\n            }\n        }\n\n        mediaRecorder.record();\n\n        timeout = setInterval(function() {\n            mediaRecorder.requestData();\n        }, timeSlice);\n    };\n\n    this.stop = function() {\n        if (mediaRecorder) {\n            mediaRecorder.stop();\n            clearTimeout(timeout);\n            this.onstop();\n        }\n    };\n\n    this.onstop = function() {};\n\n    this.clearOldRecordedFrames = function() {\n        if (mediaRecorder) {\n            mediaRecorder.clearOldRecordedFrames();\n        }\n    };\n\n    this.pause = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        mediaRecorder.pause();\n    };\n\n    this.resume = function() {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        mediaRecorder.resume();\n    };\n\n    this.ondataavailable = function() {};\n\n    // Reference to \"WhammyRecorder\" object\n    var mediaRecorder;\n    var timeout;\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.WhammyRecorder = WhammyRecorder;\n}\n\n// ==========================\n// WhammyRecorderHelper.js\n\nfunction WhammyRecorderHelper(mediaStream, root) {\n    this.record = function(timeSlice) {\n        if (!this.width) {\n            this.width = 320;\n        }\n        if (!this.height) {\n            this.height = 240;\n        }\n\n        if (this.video && this.video instanceof HTMLVideoElement) {\n            if (!this.width) {\n                this.width = video.videoWidth || video.clientWidth || 320;\n            }\n            if (!this.height) {\n                this.height = video.videoHeight || video.clientHeight || 240;\n            }\n        }\n\n        if (!this.video) {\n            this.video = {\n                width: this.width,\n                height: this.height\n            };\n        }\n\n        if (!this.canvas || !this.canvas.width || !this.canvas.height) {\n            this.canvas = {\n                width: this.width,\n                height: this.height\n            };\n        }\n\n        canvas.width = this.canvas.width;\n        canvas.height = this.canvas.height;\n\n        // setting defaults\n        if (this.video && this.video instanceof HTMLVideoElement) {\n            this.isHTMLObject = true;\n            video = this.video.cloneNode();\n        } else {\n            video = document.createElement('video');\n            video.src = URL.createObjectURL(mediaStream);\n\n            video.width = this.video.width;\n            video.height = this.video.height;\n        }\n\n        video.muted = true;\n        video.play();\n\n        lastTime = new Date().getTime();\n        whammy = new Whammy.Video(root.speed, root.quality);\n\n        console.log('canvas resolutions', canvas.width, '*', canvas.height);\n        console.log('video width/height', video.width || canvas.width, '*', video.height || canvas.height);\n\n        drawFrames();\n    };\n\n    this.clearOldRecordedFrames = function() {\n        whammy.frames = [];\n    };\n\n    var requestDataInvoked = false;\n    this.requestData = function() {\n        if (isPaused) {\n            return;\n        }\n\n        if (!whammy.frames.length) {\n            requestDataInvoked = false;\n            return;\n        }\n\n        requestDataInvoked = true;\n        // clone stuff\n        var internalFrames = whammy.frames.slice(0);\n\n        // reset the frames for the new recording\n\n        whammy.frames = dropBlackFrames(internalFrames, -1);\n\n        whammy.compile(function(whammyBlob) {\n            root.ondataavailable(whammyBlob);\n            console.debug('video recorded blob size:', bytesToSize(whammyBlob.size));\n        });\n\n        whammy.frames = [];\n\n        requestDataInvoked = false;\n    };\n\n    var isOnStartedDrawingNonBlankFramesInvoked = false;\n\n    function drawFrames() {\n        if (isPaused) {\n            lastTime = new Date().getTime();\n            setTimeout(drawFrames, 500);\n            return;\n        }\n\n        if (isStopDrawing) {\n            return;\n        }\n\n        if (requestDataInvoked) {\n            return setTimeout(drawFrames, 100);\n        }\n\n        var duration = new Date().getTime() - lastTime;\n        if (!duration) {\n            return drawFrames();\n        }\n\n        // via webrtc-experiment#206, by Jack i.e. @Seymourr\n        lastTime = new Date().getTime();\n\n        if (!self.isHTMLObject && video.paused) {\n            video.play(); // Android\n        }\n\n        context.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n        if (!isStopDrawing) {\n            whammy.frames.push({\n                duration: duration,\n                image: canvas.toDataURL('image/webp')\n            });\n        }\n\n        if (!isOnStartedDrawingNonBlankFramesInvoked && !isBlankFrame(whammy.frames[whammy.frames.length - 1])) {\n            isOnStartedDrawingNonBlankFramesInvoked = true;\n            root.onStartedDrawingNonBlankFrames();\n        }\n\n        setTimeout(drawFrames, 10);\n    }\n\n    var isStopDrawing = false;\n\n    this.stop = function() {\n        isStopDrawing = true;\n        this.requestData();\n        this.onstop();\n    };\n\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n\n    var video;\n    var lastTime;\n    var whammy;\n\n    var self = this;\n\n    function isBlankFrame(frame, _pixTolerance, _frameTolerance) {\n        var localCanvas = document.createElement('canvas');\n        localCanvas.width = canvas.width;\n        localCanvas.height = canvas.height;\n        var context2d = localCanvas.getContext('2d');\n\n        var sampleColor = {\n            r: 0,\n            g: 0,\n            b: 0\n        };\n        var maxColorDifference = Math.sqrt(\n            Math.pow(255, 2) +\n            Math.pow(255, 2) +\n            Math.pow(255, 2)\n        );\n        var pixTolerance = _pixTolerance && _pixTolerance >= 0 && _pixTolerance <= 1 ? _pixTolerance : 0;\n        var frameTolerance = _frameTolerance && _frameTolerance >= 0 && _frameTolerance <= 1 ? _frameTolerance : 0;\n\n        var matchPixCount, endPixCheck, maxPixCount;\n\n        var image = new Image();\n        image.src = frame.image;\n        context2d.drawImage(image, 0, 0, canvas.width, canvas.height);\n        var imageData = context2d.getImageData(0, 0, canvas.width, canvas.height);\n        matchPixCount = 0;\n        endPixCheck = imageData.data.length;\n        maxPixCount = imageData.data.length / 4;\n\n        for (var pix = 0; pix < endPixCheck; pix += 4) {\n            var currentColor = {\n                r: imageData.data[pix],\n                g: imageData.data[pix + 1],\n                b: imageData.data[pix + 2]\n            };\n            var colorDifference = Math.sqrt(\n                Math.pow(currentColor.r - sampleColor.r, 2) +\n                Math.pow(currentColor.g - sampleColor.g, 2) +\n                Math.pow(currentColor.b - sampleColor.b, 2)\n            );\n            // difference in color it is difference in color vectors (r1,g1,b1) <=> (r2,g2,b2)\n            if (colorDifference <= maxColorDifference * pixTolerance) {\n                matchPixCount++;\n            }\n        }\n\n        if (maxPixCount - matchPixCount <= maxPixCount * frameTolerance) {\n            return false;\n        } else {\n            return true;\n        }\n    }\n\n    function dropBlackFrames(_frames, _framesToCheck, _pixTolerance, _frameTolerance) {\n        var localCanvas = document.createElement('canvas');\n        localCanvas.width = canvas.width;\n        localCanvas.height = canvas.height;\n        var context2d = localCanvas.getContext('2d');\n        var resultFrames = [];\n\n        var checkUntilNotBlack = _framesToCheck === -1;\n        var endCheckFrame = (_framesToCheck && _framesToCheck > 0 && _framesToCheck <= _frames.length) ?\n            _framesToCheck : _frames.length;\n        var sampleColor = {\n            r: 0,\n            g: 0,\n            b: 0\n        };\n        var maxColorDifference = Math.sqrt(\n            Math.pow(255, 2) +\n            Math.pow(255, 2) +\n            Math.pow(255, 2)\n        );\n        var pixTolerance = _pixTolerance && _pixTolerance >= 0 && _pixTolerance <= 1 ? _pixTolerance : 0;\n        var frameTolerance = _frameTolerance && _frameTolerance >= 0 && _frameTolerance <= 1 ? _frameTolerance : 0;\n        var doNotCheckNext = false;\n\n        for (var f = 0; f < endCheckFrame; f++) {\n            var matchPixCount, endPixCheck, maxPixCount;\n\n            if (!doNotCheckNext) {\n                var image = new Image();\n                image.src = _frames[f].image;\n                context2d.drawImage(image, 0, 0, canvas.width, canvas.height);\n                var imageData = context2d.getImageData(0, 0, canvas.width, canvas.height);\n                matchPixCount = 0;\n                endPixCheck = imageData.data.length;\n                maxPixCount = imageData.data.length / 4;\n\n                for (var pix = 0; pix < endPixCheck; pix += 4) {\n                    var currentColor = {\n                        r: imageData.data[pix],\n                        g: imageData.data[pix + 1],\n                        b: imageData.data[pix + 2]\n                    };\n                    var colorDifference = Math.sqrt(\n                        Math.pow(currentColor.r - sampleColor.r, 2) +\n                        Math.pow(currentColor.g - sampleColor.g, 2) +\n                        Math.pow(currentColor.b - sampleColor.b, 2)\n                    );\n                    // difference in color it is difference in color vectors (r1,g1,b1) <=> (r2,g2,b2)\n                    if (colorDifference <= maxColorDifference * pixTolerance) {\n                        matchPixCount++;\n                    }\n                }\n            }\n\n            if (!doNotCheckNext && maxPixCount - matchPixCount <= maxPixCount * frameTolerance) {\n                // console.log('removed black frame : ' + f + ' ; frame duration ' + _frames[f].duration);\n            } else {\n                // console.log('frame is passed : ' + f);\n                if (checkUntilNotBlack) {\n                    doNotCheckNext = true;\n                }\n                resultFrames.push(_frames[f]);\n            }\n        }\n\n        resultFrames = resultFrames.concat(_frames.slice(endCheckFrame));\n\n        if (resultFrames.length <= 0) {\n            // at least one last frame should be available for next manipulation\n            // if total duration of all frames will be < 1000 than ffmpeg doesn't work well...\n            resultFrames.push(_frames[_frames.length - 1]);\n        }\n\n        return resultFrames;\n    }\n\n    var isPaused = false;\n\n    this.pause = function() {\n        isPaused = true;\n    };\n\n    this.resume = function() {\n        isPaused = false;\n    };\n\n    this.onstop = function() {};\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.WhammyRecorderHelper = WhammyRecorderHelper;\n}\n\n// --------------\n// GifRecorder.js\n\nfunction GifRecorder(mediaStream) {\n    if (typeof GIFEncoder === 'undefined') {\n        throw 'Please link: https://cdn.webrtc-experiment.com/gif-recorder.js';\n    }\n\n    // void start(optional long timeSlice)\n    // timestamp to fire \"ondataavailable\"\n    this.start = function(timeSlice) {\n        timeSlice = timeSlice || 1000;\n\n        var imageWidth = this.videoWidth || 320;\n        var imageHeight = this.videoHeight || 240;\n\n        canvas.width = video.width = imageWidth;\n        canvas.height = video.height = imageHeight;\n\n        // external library to record as GIF images\n        gifEncoder = new GIFEncoder();\n\n        // void setRepeat(int iter)\n        // Sets the number of times the set of GIF frames should be played.\n        // Default is 1; 0 means play indefinitely.\n        gifEncoder.setRepeat(0);\n\n        // void setFrameRate(Number fps)\n        // Sets frame rate in frames per second.\n        // Equivalent to setDelay(1000/fps).\n        // Using \"setDelay\" instead of \"setFrameRate\"\n        gifEncoder.setDelay(this.frameRate || this.speed || 200);\n\n        // void setQuality(int quality)\n        // Sets quality of color quantization (conversion of images to the\n        // maximum 256 colors allowed by the GIF specification).\n        // Lower values (minimum = 1) produce better colors,\n        // but slow processing significantly. 10 is the default,\n        // and produces good color mapping at reasonable speeds.\n        // Values greater than 20 do not yield significant improvements in speed.\n        gifEncoder.setQuality(this.quality || 1);\n\n        // Boolean start()\n        // This writes the GIF Header and returns false if it fails.\n        gifEncoder.start();\n\n        startTime = Date.now();\n\n        function drawVideoFrame(time) {\n            if (isPaused) {\n                setTimeout(drawVideoFrame, 500, time);\n                return;\n            }\n\n            lastAnimationFrame = requestAnimationFrame(drawVideoFrame);\n\n            if (typeof lastFrameTime === undefined) {\n                lastFrameTime = time;\n            }\n\n            // ~10 fps\n            if (time - lastFrameTime < 90) {\n                return;\n            }\n\n            if (video.paused) {\n                video.play(); // Android\n            }\n\n            context.drawImage(video, 0, 0, imageWidth, imageHeight);\n\n            gifEncoder.addFrame(context);\n\n            // console.log('Recording...' + Math.round((Date.now() - startTime) / 1000) + 's');\n            // console.log(\"fps: \", 1000 / (time - lastFrameTime));\n\n            lastFrameTime = time;\n        }\n\n        lastAnimationFrame = requestAnimationFrame(drawVideoFrame);\n\n        timeout = setTimeout(doneRecording, timeSlice);\n    };\n\n    function doneRecording() {\n        endTime = Date.now();\n\n        var gifBlob = new Blob([new Uint8Array(gifEncoder.stream().bin)], {\n            type: 'image/gif'\n        });\n        self.ondataavailable(gifBlob);\n\n        // todo: find a way to clear old recorded blobs\n        gifEncoder.stream().bin = [];\n    }\n\n    this.stop = function() {\n        if (lastAnimationFrame) {\n            cancelAnimationFrame(lastAnimationFrame);\n            clearTimeout(timeout);\n            doneRecording();\n            this.onstop();\n        }\n    };\n\n    this.onstop = function() {};\n\n    var isPaused = false;\n\n    this.pause = function() {\n        isPaused = true;\n    };\n\n    this.resume = function() {\n        isPaused = false;\n    };\n\n    this.ondataavailable = function() {};\n    this.onstop = function() {};\n\n    // Reference to itself\n    var self = this;\n\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n\n    var video = document.createElement('video');\n    video.muted = true;\n    video.autoplay = true;\n    video.src = URL.createObjectURL(mediaStream);\n    video.play();\n\n    var lastAnimationFrame = null;\n    var startTime, endTime, lastFrameTime;\n\n    var gifEncoder;\n    var timeout;\n}\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.GifRecorder = GifRecorder;\n}\n\n// https://github.com/antimatter15/whammy/blob/master/LICENSE\n// _________\n// Whammy.js\n\n// todo: Firefox now supports webp for webm containers!\n// their MediaRecorder implementation works well!\n// should we provide an option to record via Whammy.js or MediaRecorder API is a better solution?\n\n/**\n * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}\n * @summary A real time javascript webm encoder based on a canvas hack.\n * @typedef Whammy\n * @class\n * @example\n * var recorder = new Whammy().Video(15);\n * recorder.add(context || canvas || dataURL);\n * var output = recorder.compile();\n */\n\nvar Whammy = (function() {\n    // a more abstract-ish API\n\n    function WhammyVideo(duration, quality) {\n        this.frames = [];\n        if (!duration) {\n            duration = 1;\n        }\n        this.duration = 1000 / duration;\n        this.quality = quality || 0.8;\n    }\n\n    /**\n     * Pass Canvas or Context or image/webp(string) to {@link Whammy} encoder.\n     * @method\n     * @memberof Whammy\n     * @example\n     * recorder = new Whammy().Video(0.8, 100);\n     * recorder.add(canvas || context || 'image/webp');\n     * @param {string} frame - Canvas || Context || image/webp\n     * @param {number} duration - Stick a duration (in milliseconds)\n     */\n    WhammyVideo.prototype.add = function(frame, duration) {\n        if ('canvas' in frame) { //CanvasRenderingContext2D\n            frame = frame.canvas;\n        }\n\n        if ('toDataURL' in frame) {\n            frame = frame.toDataURL('image/webp', this.quality);\n        }\n\n        if (!(/^data:image\\/webp;base64,/ig).test(frame)) {\n            throw 'Input must be formatted properly as a base64 encoded DataURI of type image/webp';\n        }\n        this.frames.push({\n            image: frame,\n            duration: duration || this.duration\n        });\n    };\n\n    function processInWebWorker(_function) {\n        var blob = URL.createObjectURL(new Blob([_function.toString(),\n            'this.onmessage =  function (e) {' + _function.name + '(e.data);}'\n        ], {\n            type: 'application/javascript'\n        }));\n\n        var worker = new Worker(blob);\n        URL.revokeObjectURL(blob);\n        return worker;\n    }\n\n    function whammyInWebWorker(frames) {\n        function ArrayToWebM(frames) {\n            var info = checkFrames(frames);\n            if (!info) {\n                return [];\n            }\n\n            var clusterMaxDuration = 30000;\n\n            var EBML = [{\n                'id': 0x1a45dfa3, // EBML\n                'data': [{\n                    'data': 1,\n                    'id': 0x4286 // EBMLVersion\n                }, {\n                    'data': 1,\n                    'id': 0x42f7 // EBMLReadVersion\n                }, {\n                    'data': 4,\n                    'id': 0x42f2 // EBMLMaxIDLength\n                }, {\n                    'data': 8,\n                    'id': 0x42f3 // EBMLMaxSizeLength\n                }, {\n                    'data': 'webm',\n                    'id': 0x4282 // DocType\n                }, {\n                    'data': 2,\n                    'id': 0x4287 // DocTypeVersion\n                }, {\n                    'data': 2,\n                    'id': 0x4285 // DocTypeReadVersion\n                }]\n            }, {\n                'id': 0x18538067, // Segment\n                'data': [{\n                    'id': 0x1549a966, // Info\n                    'data': [{\n                        'data': 1e6, //do things in millisecs (num of nanosecs for duration scale)\n                        'id': 0x2ad7b1 // TimecodeScale\n                    }, {\n                        'data': 'whammy',\n                        'id': 0x4d80 // MuxingApp\n                    }, {\n                        'data': 'whammy',\n                        'id': 0x5741 // WritingApp\n                    }, {\n                        'data': doubleToString(info.duration),\n                        'id': 0x4489 // Duration\n                    }]\n                }, {\n                    'id': 0x1654ae6b, // Tracks\n                    'data': [{\n                        'id': 0xae, // TrackEntry\n                        'data': [{\n                            'data': 1,\n                            'id': 0xd7 // TrackNumber\n                        }, {\n                            'data': 1,\n                            'id': 0x73c5 // TrackUID\n                        }, {\n                            'data': 0,\n                            'id': 0x9c // FlagLacing\n                        }, {\n                            'data': 'und',\n                            'id': 0x22b59c // Language\n                        }, {\n                            'data': 'V_VP8',\n                            'id': 0x86 // CodecID\n                        }, {\n                            'data': 'VP8',\n                            'id': 0x258688 // CodecName\n                        }, {\n                            'data': 1,\n                            'id': 0x83 // TrackType\n                        }, {\n                            'id': 0xe0, // Video\n                            'data': [{\n                                'data': info.width,\n                                'id': 0xb0 // PixelWidth\n                            }, {\n                                'data': info.height,\n                                'id': 0xba // PixelHeight\n                            }]\n                        }]\n                    }]\n                }]\n            }];\n\n            //Generate clusters (max duration)\n            var frameNumber = 0;\n            var clusterTimecode = 0;\n            while (frameNumber < frames.length) {\n\n                var clusterFrames = [];\n                var clusterDuration = 0;\n                do {\n                    clusterFrames.push(frames[frameNumber]);\n                    clusterDuration += frames[frameNumber].duration;\n                    frameNumber++;\n                } while (frameNumber < frames.length && clusterDuration < clusterMaxDuration);\n\n                var clusterCounter = 0;\n                var cluster = {\n                    'id': 0x1f43b675, // Cluster\n                    'data': getClusterData(clusterTimecode, clusterCounter, clusterFrames)\n                }; //Add cluster to segment\n                EBML[1].data.push(cluster);\n                clusterTimecode += clusterDuration;\n            }\n\n            return generateEBML(EBML);\n        }\n\n        function getClusterData(clusterTimecode, clusterCounter, clusterFrames) {\n            return [{\n                'data': clusterTimecode,\n                'id': 0xe7 // Timecode\n            }].concat(clusterFrames.map(function(webp) {\n                var block = makeSimpleBlock({\n                    discardable: 0,\n                    frame: webp.data.slice(4),\n                    invisible: 0,\n                    keyframe: 1,\n                    lacing: 0,\n                    trackNum: 1,\n                    timecode: Math.round(clusterCounter)\n                });\n                clusterCounter += webp.duration;\n                return {\n                    data: block,\n                    id: 0xa3\n                };\n            }));\n        }\n\n        // sums the lengths of all the frames and gets the duration\n\n        function checkFrames(frames) {\n            if (!frames[0]) {\n                postMessage({\n                    error: 'Something went wrong. Maybe WebP format is not supported in the current browser.'\n                });\n                return;\n            }\n\n            var width = frames[0].width,\n                height = frames[0].height,\n                duration = frames[0].duration;\n\n            for (var i = 1; i < frames.length; i++) {\n                duration += frames[i].duration;\n            }\n            return {\n                duration: duration,\n                width: width,\n                height: height\n            };\n        }\n\n        function numToBuffer(num) {\n            var parts = [];\n            while (num > 0) {\n                parts.push(num & 0xff);\n                num = num >> 8;\n            }\n            return new Uint8Array(parts.reverse());\n        }\n\n        function strToBuffer(str) {\n            return new Uint8Array(str.split('').map(function(e) {\n                return e.charCodeAt(0);\n            }));\n        }\n\n        function bitsToBuffer(bits) {\n            var data = [];\n            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';\n            bits = pad + bits;\n            for (var i = 0; i < bits.length; i += 8) {\n                data.push(parseInt(bits.substr(i, 8), 2));\n            }\n            return new Uint8Array(data);\n        }\n\n        function generateEBML(json) {\n            var ebml = [];\n            for (var i = 0; i < json.length; i++) {\n                var data = json[i].data;\n\n                if (typeof data === 'object') {\n                    data = generateEBML(data);\n                }\n\n                if (typeof data === 'number') {\n                    data = bitsToBuffer(data.toString(2));\n                }\n\n                if (typeof data === 'string') {\n                    data = strToBuffer(data);\n                }\n\n                var len = data.size || data.byteLength || data.length;\n                var zeroes = Math.ceil(Math.ceil(Math.log(len) / Math.log(2)) / 8);\n                var sizeToString = len.toString(2);\n                var padded = (new Array((zeroes * 7 + 7 + 1) - sizeToString.length)).join('0') + sizeToString;\n                var size = (new Array(zeroes)).join('0') + '1' + padded;\n\n                ebml.push(numToBuffer(json[i].id));\n                ebml.push(bitsToBuffer(size));\n                ebml.push(data);\n            }\n\n            return new Blob(ebml, {\n                type: 'video/webm'\n            });\n        }\n\n        function toBinStrOld(bits) {\n            var data = '';\n            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';\n            bits = pad + bits;\n            for (var i = 0; i < bits.length; i += 8) {\n                data += String.fromCharCode(parseInt(bits.substr(i, 8), 2));\n            }\n            return data;\n        }\n\n        function makeSimpleBlock(data) {\n            var flags = 0;\n\n            if (data.keyframe) {\n                flags |= 128;\n            }\n\n            if (data.invisible) {\n                flags |= 8;\n            }\n\n            if (data.lacing) {\n                flags |= (data.lacing << 1);\n            }\n\n            if (data.discardable) {\n                flags |= 1;\n            }\n\n            if (data.trackNum > 127) {\n                throw 'TrackNumber > 127 not supported';\n            }\n\n            var out = [data.trackNum | 0x80, data.timecode >> 8, data.timecode & 0xff, flags].map(function(e) {\n                return String.fromCharCode(e);\n            }).join('') + data.frame;\n\n            return out;\n        }\n\n        function parseWebP(riff) {\n            var VP8 = riff.RIFF[0].WEBP[0];\n\n            var frameStart = VP8.indexOf('\\x9d\\x01\\x2a'); // A VP8 keyframe starts with the 0x9d012a header\n            for (var i = 0, c = []; i < 4; i++) {\n                c[i] = VP8.charCodeAt(frameStart + 3 + i);\n            }\n\n            var width, height, tmp;\n\n            //the code below is literally copied verbatim from the bitstream spec\n            tmp = (c[1] << 8) | c[0];\n            width = tmp & 0x3FFF;\n            tmp = (c[3] << 8) | c[2];\n            height = tmp & 0x3FFF;\n            return {\n                width: width,\n                height: height,\n                data: VP8,\n                riff: riff\n            };\n        }\n\n        function getStrLength(string, offset) {\n            return parseInt(string.substr(offset + 4, 4).split('').map(function(i) {\n                var unpadded = i.charCodeAt(0).toString(2);\n                return (new Array(8 - unpadded.length + 1)).join('0') + unpadded;\n            }).join(''), 2);\n        }\n\n        function parseRIFF(string) {\n            var offset = 0;\n            var chunks = {};\n\n            while (offset < string.length) {\n                var id = string.substr(offset, 4);\n                var len = getStrLength(string, offset);\n                var data = string.substr(offset + 4 + 4, len);\n                offset += 4 + 4 + len;\n                chunks[id] = chunks[id] || [];\n\n                if (id === 'RIFF' || id === 'LIST') {\n                    chunks[id].push(parseRIFF(data));\n                } else {\n                    chunks[id].push(data);\n                }\n            }\n            return chunks;\n        }\n\n        function doubleToString(num) {\n            return [].slice.call(\n                new Uint8Array((new Float64Array([num])).buffer), 0).map(function(e) {\n                return String.fromCharCode(e);\n            }).reverse().join('');\n        }\n\n        var webm = new ArrayToWebM(frames.map(function(frame) {\n            var webp = parseWebP(parseRIFF(atob(frame.image.slice(23))));\n            webp.duration = frame.duration;\n            return webp;\n        }));\n\n        postMessage(webm);\n    }\n\n    /**\n     * Encodes frames in WebM container. It uses WebWorkinvoke to invoke 'ArrayToWebM' method.\n     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.\n     * @method\n     * @memberof Whammy\n     * @example\n     * recorder = new Whammy().Video(0.8, 100);\n     * recorder.compile(function(blob) {\n     *    // blob.size - blob.type\n     * });\n     */\n    WhammyVideo.prototype.compile = function(callback) {\n        var webWorker = processInWebWorker(whammyInWebWorker);\n\n        webWorker.onmessage = function(event) {\n            if (event.data.error) {\n                console.error(event.data.error);\n                return;\n            }\n            callback(event.data);\n        };\n\n        webWorker.postMessage(this.frames);\n    };\n\n    return {\n        /**\n         * A more abstract-ish API.\n         * @method\n         * @memberof Whammy\n         * @example\n         * recorder = new Whammy().Video(0.8, 100);\n         * @param {?number} speed - 0.8\n         * @param {?number} quality - 100\n         */\n        Video: WhammyVideo\n    };\n})();\n\nif (typeof MediaStreamRecorder !== 'undefined') {\n    MediaStreamRecorder.Whammy = Whammy;\n}\n\n// Last time updated at Nov 18, 2014, 08:32:23\n\n// Latest file can be found here: https://cdn.webrtc-experiment.com/ConcatenateBlobs.js\n\n// Muaz Khan    - www.MuazKhan.com\n// MIT License  - www.WebRTC-Experiment.com/licence\n// Source Code  - https://github.com/muaz-khan/ConcatenateBlobs\n// Demo         - https://www.WebRTC-Experiment.com/ConcatenateBlobs/\n\n// ___________________\n// ConcatenateBlobs.js\n\n// Simply pass array of blobs.\n// This javascript library will concatenate all blobs in single \"Blob\" object.\n\n(function() {\n    window.ConcatenateBlobs = function(blobs, type, callback) {\n        var buffers = [];\n\n        var index = 0;\n\n        function readAsArrayBuffer() {\n            if (!blobs[index]) {\n                return concatenateBuffers();\n            }\n            var reader = new FileReader();\n            reader.onload = function(event) {\n                buffers.push(event.target.result);\n                index++;\n                readAsArrayBuffer();\n            };\n            reader.readAsArrayBuffer(blobs[index]);\n        }\n\n        readAsArrayBuffer();\n\n        function concatenateBuffers() {\n            var byteLength = 0;\n            buffers.forEach(function(buffer) {\n                byteLength += buffer.byteLength;\n            });\n\n            var tmp = new Uint16Array(byteLength);\n            var lastOffset = 0;\n            buffers.forEach(function(buffer) {\n                // BYTES_PER_ELEMENT == 2 for Uint16Array\n                var reusableByteLength = buffer.byteLength;\n                if (reusableByteLength % 2 != 0) {\n                    buffer = buffer.slice(0, reusableByteLength - 1)\n                }\n                tmp.set(new Uint16Array(buffer), lastOffset);\n                lastOffset += reusableByteLength;\n            });\n\n            var blob = new Blob([tmp.buffer], {\n                type: type\n            });\n\n            callback(blob);\n        }\n    };\n})();\n\n// https://github.com/streamproc/MediaStreamRecorder/issues/42\nif (typeof module !== 'undefined' /* && !!module.exports*/ ) {\n    module.exports = MediaStreamRecorder;\n}\n\nif (typeof define === 'function' && define.amd) {\n    define('MediaStreamRecorder', [], function() {\n        return MediaStreamRecorder;\n    });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('BitRateTest',{attrs:{\"msg\":\"Welcome to Your Vue.js App\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"SampleVideo \"+_vm._s(_vm.resolution)+\" \"+_vm._s(_vm.status))]),_c('h2',[_vm._v(\"Now Working : \"+_vm._s(_vm.recLib))]),(_vm.blobCount > 0)?_c('h2',[_vm._v(\"Blob Chunk Count : \"+_vm._s(_vm.blobCount))]):_vm._e(),_c('div',{staticClass:\"wrapper\"},[_c('div',[_c('fieldset',[_c('legend',[_vm._v(\"Select Recordr\")]),_c('button',{on:{\"click\":function($event){return _vm.setRecLib($event,'recordrtc')}}},[_vm._v(\"RecordRTC\")]),_c('button',{on:{\"click\":function($event){return _vm.setRecLib($event, 'msr')}}},[_vm._v(\"streamproc/MediaStreamRecorder\")])]),_c('fieldset',[_c('legend',[_vm._v(\"set width and height\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.resolution),expression:\"resolution\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.resolution=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.resolutionList),function(option,idx){return _c('option',{key:idx,domProps:{\"value\":option.value}},[_vm._v(_vm._s(option.key))])}),0)]),_c('fieldset',[_c('legend',[_vm._v(\"select Bitrate\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.bitrate),expression:\"bitrate\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.bitrate=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.bitrateList),function(option,idx){return _c('option',{key:idx,domProps:{\"value\":option.value}},[_vm._v(_vm._s(option.key))])}),0)]),_c('fieldset',[_c('legend',[_vm._v(\"Start Record\")]),_c('button',{on:{\"click\":_vm.videoRecording}},[_vm._v(\"영상만 녹화하기\")]),_c('button',{on:{\"click\":_vm.screenRecording}},[_vm._v(\"스크린 녹화하기\")])]),_c('fieldset',[_c('legend',[_vm._v(\"Save Option - TimeSlice에서만 동작하는 옵션\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.saveOpt),expression:\"saveOpt\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.saveOpt=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.saveOptList),function(option,idx){return _c('option',{key:idx,domProps:{\"value\":option.value}},[_vm._v(_vm._s(option.key))])}),0)]),_c('fieldset',[_c('legend',[_vm._v(\"Start Record(Timeslice mode)\")]),_c('button',{on:{\"click\":function($event){return _vm.videoRecording($event, _vm.timeslice = true)}}},[_vm._v(\"영상 녹화 (Timeslice)\")]),_c('button',{on:{\"click\":function($event){return _vm.screenRecording($event, _vm.timeslice = true)}}},[_vm._v(\"스크린 녹화 (Timeslice)\")]),_vm._v(\" timeslice ms \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.timeSliceValue),expression:\"timeSliceValue\"}],attrs:{\"placeholder\":\"timeslice second(ms)\"},domProps:{\"value\":(_vm.timeSliceValue)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.timeSliceValue=$event.target.value}}})]),_c('fieldset',[_c('legend',[_vm._v(\"Stop\")]),_c('button',{on:{\"click\":_vm.stopMultiRecorder}},[_vm._v(\"stop Multi\")]),_c('button',{on:{\"click\":_vm.sendMessage}},[_vm._v(\"sendMessage\")])]),_c('div',{staticClass:\"wrapper\"},[_c('fieldset',[_c('legend',[_vm._v(\"worker\")]),_c('div',[_c('button',{on:{\"click\":function($event){return _vm.toggleWorkerVideo()}}},[_vm._v(\"Toggle Video\")]),_c('button',{on:{\"click\":function($event){return _vm.toggleWorkerSound()}}},[_vm._v(\"Toggle Audio\")])]),_c('video',{ref:\"workerStream\",staticStyle:{\"width\":\"640px\",\"height\":\"480px\"},attrs:{\"autoplay\":\"\"},domProps:{\"srcObject\":_vm.cameraStream}})]),_c('fieldset',[_c('legend',[_vm._v(\"Audio Set\")]),_c('div',[_vm._v(\" 1 \"),_c('button',{on:{\"click\":function($event){return _vm.play($event,'remoteStream1')}}},[_vm._v(\"Play\")]),_c('button',{on:{\"click\":function($event){return _vm.stop($event,'remoteStream1')}}},[_vm._v(\"Stop\")]),_c('button',{on:{\"click\":function($event){return _vm.toggleRemoteSound($event,'remoteStream1')}}},[_vm._v(\"Toggle Audio\")]),_c('video',{ref:\"remoteStream1\",staticStyle:{\"width\":\"100px\",\"height\":\"100px\"},attrs:{\"src\":\"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4\",\"loop\":\"true\",\"crossorigin\":\"anonymous\"}})]),_c('div',[_vm._v(\" 2 \"),_c('button',{on:{\"click\":function($event){return _vm.play($event,'remoteStream2')}}},[_vm._v(\"Play\")]),_c('button',{on:{\"click\":function($event){return _vm.stop($event,'remoteStream2')}}},[_vm._v(\"Stop\")]),_c('button',{on:{\"click\":function($event){return _vm.toggleRemoteSound($event,'remoteStream2')}}},[_vm._v(\"Toggle Audio\")]),_c('video',{ref:\"remoteStream2\",staticStyle:{\"width\":\"100px\",\"height\":\"100px\"},attrs:{\"src\":\"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4\",\"loop\":\"true\",\"crossorigin\":\"anonymous\"}})]),_c('div',[_vm._v(\" 3 \"),_c('button',{on:{\"click\":function($event){return _vm.play($event,'remoteStream3')}}},[_vm._v(\"Play\")]),_c('button',{on:{\"click\":function($event){return _vm.stop($event,'remoteStream3')}}},[_vm._v(\"Stop\")]),_c('button',{on:{\"click\":function($event){return _vm.toggleRemoteSound($event,'remoteStream3')}}},[_vm._v(\"Toggle Audio\")]),_c('video',{ref:\"remoteStream3\",staticStyle:{\"width\":\"100px\",\"height\":\"100px\"},attrs:{\"src\":\"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4\",\"loop\":\"true\",\"crossorigin\":\"anonymous\"}})])])])]),_c('div',[_c('fieldset',[_c('legend',[_vm._v(\"Status\")]),_c('h3',[_vm._v(\"Worker Video : \"+_vm._s(_vm.workerVideoStatus))]),_c('h3',[_vm._v(\"Worker Audio : \"+_vm._s(_vm.workerAudioStatus))]),_c('br'),_c('h3',[_vm._v(\"Remote Stream1 Audio : \"+_vm._s(_vm.remote1AudioStatus))]),_c('br'),_c('h3',[_vm._v(\"Remote Stream2 Audio : \"+_vm._s(_vm.remote2AudioStatus))]),_c('br'),_c('h3',[_vm._v(\"Remote Stream3 Audio : \"+_vm._s(_vm.remote3AudioStatus))])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Dexie from \"dexie\";\r\n\r\nconst db = new Dexie(\"MediaChunk\");\r\n\r\nfunction initIDB() {\r\n  console.log(\"init\");\r\n  db.version(1).stores({\r\n    mediaChunk: \"++id, uuid, chunkNumber, filename, blob\",\r\n  });\r\n  console.log(db);\r\n}\r\n\r\nasync function addMediaChunk(uuid, chunkNumber, fileName, blob) {\r\n  await db.mediaChunk.add({\r\n    uuid: uuid,\r\n    chunkNumber: chunkNumber,\r\n    fileName: fileName,\r\n    blob: blob,\r\n  });\r\n}\r\n\r\nasync function getMediaChunkArray(uuid) {\r\n  console.log(uuid)\r\n\r\n  return await db.mediaChunk\r\n    .where(\"uuid\")\r\n    .equals(uuid)\r\n    .toArray()\r\n}\r\n\r\nconst IDBHelper = {\r\n  initIDB: initIDB,\r\n  addMediaChunk: addMediaChunk,\r\n  getMediaChunkArray: getMediaChunkArray,\r\n};\r\n\r\nexport default IDBHelper;\r\n","<template>\r\n\t<div>\r\n\t\t<h1>SampleVideo {{resolution}} {{status}}</h1>\r\n\t\t<h2>Now Working : {{recLib}}</h2>\r\n\t\t<h2 v-if=\"blobCount > 0\">Blob Chunk Count : {{blobCount}}</h2>\r\n\r\n\t\t<div class=\"wrapper\">\r\n\t\t\t<div>\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>Select Recordr</legend>\r\n\t\t\t\t\t<button @click=\"setRecLib($event,'recordrtc')\">RecordRTC</button>\r\n\t\t\t\t\t<button @click=\"setRecLib($event, 'msr')\">streamproc/MediaStreamRecorder</button>\r\n\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>set width and height</legend>\r\n\t\t\t\t\t<select v-model=\"resolution\">\r\n\t\t\t\t\t\t<option\r\n\t\t\t\t\t\t\tv-for=\"(option, idx) in resolutionList\"\r\n\t\t\t\t\t\t\t:key=\"idx\"\r\n\t\t\t\t\t\t\t:value=\"option.value\"\r\n\t\t\t\t\t\t>{{ option.key }}</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>select Bitrate</legend>\r\n\t\t\t\t\t<select v-model=\"bitrate\">\r\n\t\t\t\t\t\t<option v-for=\"(option, idx) in bitrateList\" :key=\"idx\" :value=\"option.value\">{{ option.key }}</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</fieldset>\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>Start Record</legend>\r\n\r\n\t\t\t\t\t<!-- 영상만 녹화 -->\r\n\t\t\t\t\t<button @click=\"videoRecording\">영상만 녹화하기</button>\r\n\t\t\t\t\t<button @click=\"screenRecording\">스크린 녹화하기</button>\r\n\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>Save Option - TimeSlice에서만 동작하는 옵션</legend>\r\n\t\t\t\t\t<select v-model=\"saveOpt\">\r\n\t\t\t\t\t\t<option v-for=\"(option, idx) in saveOptList\" :key=\"idx\" :value=\"option.value\">{{option.key}}</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>Start Record(Timeslice mode)</legend>\r\n\t\t\t\t\t<button @click=\"videoRecording($event, timeslice = true)\">영상 녹화 (Timeslice)</button>\r\n\t\t\t\t\t<button @click=\"screenRecording($event, timeslice = true)\">스크린 녹화 (Timeslice)</button>\r\n\t\t\t\t\ttimeslice ms\r\n\t\t\t\t\t<input v-model=\"timeSliceValue\" placeholder=\"timeslice second(ms)\" />\r\n\t\t\t\t\t<!-- end Timer ->\r\n\t\t\t\t\t<input v-model=\"endTimer\" placeholder=\"end timer\" /> -->\r\n\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>Stop</legend>\r\n\t\t\t\t\t<button @click=\"stopMultiRecorder\">stop Multi</button>\r\n\t\t\t\t\t<button @click=\"sendMessage\">sendMessage</button>\r\n\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t<!-- <fieldset>\r\n\t\t\t\t\t<legend>Special Button</legend>\r\n\t\t\t\t\t<button @click=\"recordOneHour\">Record One Hour</button>\r\n\t\t\t\t</fieldset> -->\r\n\r\n\t\t\t\t<div class=\"wrapper\">\r\n\t\t\t\t\t<fieldset>\r\n\t\t\t\t\t\t<legend>worker</legend>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<button @click=\"toggleWorkerVideo()\">Toggle Video</button>\r\n\t\t\t\t\t\t\t<button @click=\"toggleWorkerSound()\">Toggle Audio</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\tref=\"workerStream\"\r\n\t\t\t\t\t\t\tautoplay\r\n\t\t\t\t\t\t\t:srcObject.prop=\"cameraStream\"\r\n\t\t\t\t\t\t\tstyle=\"width:640px; height:480px;\"\r\n\t\t\t\t\t\t></video>\r\n\t\t\t\t\t</fieldset>\r\n\r\n\t\t\t\t\t<fieldset>\r\n\t\t\t\t\t\t<legend>Audio Set</legend>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t<button @click=\"play($event,'remoteStream1')\">Play</button>\r\n\t\t\t\t\t\t\t<button @click=\"stop($event,'remoteStream1')\">Stop</button>\r\n\t\t\t\t\t\t\t<!-- <button @click=\"toggleRemoteVideo($event,'remoteStream1')\">Toggle Video</button> -->\r\n\t\t\t\t\t\t\t<button @click=\"toggleRemoteSound($event,'remoteStream1')\">Toggle Audio</button>\r\n\t\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\t\tsrc=\"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4\"\r\n\t\t\t\t\t\t\t\tref=\"remoteStream1\"\r\n\t\t\t\t\t\t\t\tstyle=\"width:100px; height:100px\"\r\n\t\t\t\t\t\t\t\tloop=\"true\"\r\n\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\t></video>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t2\r\n\t\t\t\t\t\t\t<button @click=\"play($event,'remoteStream2')\">Play</button>\r\n\t\t\t\t\t\t\t<button @click=\"stop($event,'remoteStream2')\">Stop</button>\r\n\t\t\t\t\t\t\t<!-- <button @click=\"toggleRemoteVideo($event,'remoteStream2')\">Toggle Video</button> -->\r\n\t\t\t\t\t\t\t<button @click=\"toggleRemoteSound($event,'remoteStream2')\">Toggle Audio</button>\r\n\t\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\t\tsrc=\"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4\"\r\n\t\t\t\t\t\t\t\tref=\"remoteStream2\"\r\n\t\t\t\t\t\t\t\tstyle=\"width:100px; height:100px\"\r\n\t\t\t\t\t\t\t\tloop=\"true\"\r\n\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\t></video>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t3\r\n\t\t\t\t\t\t\t<button @click=\"play($event,'remoteStream3')\">Play</button>\r\n\t\t\t\t\t\t\t<button @click=\"stop($event,'remoteStream3')\">Stop</button>\r\n\t\t\t\t\t\t\t<!-- <button @click=\"toggleRemoteVideo($event,'remoteStream3')\">Toggle Video</button> -->\r\n\t\t\t\t\t\t\t<button @click=\"toggleRemoteSound($event,'remoteStream3')\">Toggle Audio</button>\r\n\t\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\t\tsrc=\"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4\"\r\n\t\t\t\t\t\t\t\tref=\"remoteStream3\"\r\n\t\t\t\t\t\t\t\tstyle=\"width:100px; height:100px\"\r\n\t\t\t\t\t\t\t\tloop=\"true\"\r\n\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\t></video>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</fieldset>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<fieldset>\r\n\t\t\t\t\t<legend>Status</legend>\r\n\t\t\t\t\t<h3>Worker Video : {{workerVideoStatus}}</h3>\r\n\t\t\t\t\t<h3>Worker Audio : {{workerAudioStatus}}</h3>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<h3>Remote Stream1 Audio : {{remote1AudioStatus}}</h3>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<h3>Remote Stream2 Audio : {{remote2AudioStatus}}</h3>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<h3>Remote Stream3 Audio : {{remote3AudioStatus}}</h3>\r\n\t\t\t\t</fieldset>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport RecordRTC from \"recordrtc\";\r\nimport io from \"socket.io-client\";\r\nimport IDBHelper from \"../utils/IDBHelper.js\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\nimport MSR from \"../utils/MediaStreamRecorder/MediaStreamRecorder.js\";\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\trecLib: \"recordrtc\",\r\n\t\t\trecorderType: null,\r\n\r\n\t\t\tmsrObj: {},\r\n\r\n\t\t\toption: {\r\n\t\t\t\ttype: \"video\",\r\n\t\t\t\t//mimeType: \"video/webm\",\r\n\r\n\t\t\t\t//WhammyRecorder에서만 동작하는 옵션임\r\n\t\t\t\t// canvas: {\r\n\t\t\t\t// \twidth: 1234,\r\n\t\t\t\t// \theight: 678\r\n\t\t\t\t// }\r\n\t\t\t},\r\n\t\t\tmimeType: \"video/webm;codecs=vp9\",\r\n\t\t\t//mimeType: \"video/webm\",\r\n\t\t\tfileName: \"test.mp4\",\r\n\t\t\tuuid: \"\",\r\n\t\t\tstream: null,\r\n\t\t\tscreenStream: null,\r\n\t\t\tcameraStream: null,\r\n\r\n\t\t\t//stream status\r\n\t\t\tworkerVideoStatus: true,\r\n\t\t\tworkerAudioStatus: true,\r\n\r\n\t\t\tremote1VideoStatus: true,\r\n\t\t\tremote1AudioStatus: true,\r\n\r\n\t\t\tremote2VideoStatus: true,\r\n\t\t\tremote2AudioStatus: true,\r\n\r\n\t\t\tremote3VideoStatus: true,\r\n\t\t\tremote3AudioStatus: true,\r\n\r\n\t\t\tremoteStream1: null,\r\n\t\t\tremoteStream2: null,\r\n\t\t\tremoteStream3: null,\r\n\r\n\t\t\trecorder: null,\r\n\t\t\tmultiRecorder: null,\r\n\t\t\tbitrate: 1000000,\r\n\t\t\tresolution: \"720p\",\r\n\t\t\twidth: 640,\r\n\t\t\theight: 480,\r\n\t\t\tstatus: \"Idle\",\r\n\t\t\tchunkEnd: false,\r\n\t\t\tblobCount: 0,\r\n\t\t\ttimeSliceValue: 5000,\r\n\t\t\tendTimer: 0,\r\n\t\t\tsaveOpt: \"\",\r\n\t\t\tresolutionList: [\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"360p - 480 x 360\",\r\n\t\t\t\t\tvalue: \"360p\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"480p - 640 x 480\",\r\n\t\t\t\t\tvalue: \"480p\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"720p - 1280 x 720\",\r\n\t\t\t\t\tvalue: \"720p\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"1080p - 1920 x 1080\",\r\n\t\t\t\t\tvalue: \"1080p\"\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tbitrateList: [\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"16kbit/s - 화상전화 품질\",\r\n\t\t\t\t\tvalue: 16000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"64kbit/s\",\r\n\t\t\t\t\tvalue: 64000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"128kbit/s - 화상회의 품질\",\r\n\t\t\t\t\tvalue: 128000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"256kbit/s\",\r\n\t\t\t\t\tvalue: 256000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"400kbit/s - YouTube 240p\",\r\n\t\t\t\t\tvalue: 400000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"750kbit/s - YouTube 360p\",\r\n\t\t\t\t\tvalue: 750000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"1Mbit/s - YouTube 480p\",\r\n\t\t\t\t\tvalue: 1000000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"2.5Mbit/s - YouTube 720p\",\r\n\t\t\t\t\tvalue: 2500000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"3.8Mbit/s - YouTube 720p60FPS\",\r\n\t\t\t\t\tvalue: 3800000\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"4.5Mbit/s - YouTube 1280p\",\r\n\t\t\t\t\tvalue: 4500000\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tsaveOptList: [\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"파일로 저장하기\",\r\n\t\t\t\t\tvalue: \"file\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"배열에 저장\",\r\n\t\t\t\t\tvalue: \"array\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tkey: \"indexed db에 저장\",\r\n\t\t\t\t\tvalue: \"idb\"\r\n\t\t\t\t},\r\n\t\t\t\t// {\r\n\t\t\t\t// \tkey: \"FileSystem에 저장\",\r\n\t\t\t\t// \tvalue: \"fileSystem\"\"\r\n\t\t\t\t// }\r\n\t\t\t],\r\n\t\t\tsocket: null,\r\n\t\t\tchunkArray: []\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\tresolution: {\r\n\t\t\thandler(newRes, oldRes) {\r\n\t\t\t\tconst selectedRes = newRes === undefined ? oldRes : newRes;\r\n\r\n\t\t\t\tswitch (selectedRes) {\r\n\t\t\t\t\tcase \"360p\":\r\n\t\t\t\t\t\tthis.width = 480;\r\n\t\t\t\t\t\tthis.height = 360;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"480p\":\r\n\t\t\t\t\t\tthis.width = 640;\r\n\t\t\t\t\t\tthis.height = 480;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"720p\":\r\n\t\t\t\t\t\tthis.width = 1280;\r\n\t\t\t\t\t\tthis.height = 720;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"1080p\":\r\n\t\t\t\t\t\tthis.width = 1920;\r\n\t\t\t\t\t\tthis.height = 1080;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log(\"Wrong Res!!!\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\timmediate: true\r\n\t\t}\r\n\t},\r\n\tcomponents: {},\r\n\tmethods: {\r\n\t\tasync init() {\r\n\t\t\tIDBHelper.initIDB();\r\n\t\t\tthis.uuid = uuidv4();\r\n\r\n\t\t\tconst constraints = {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tvideo: true\r\n\t\t\t};\r\n\t\t\tthis.socket = io(\"http://localhost:8080\");\r\n\t\t\tthis.socket.on(\"recMsg\", function(data) {\r\n\t\t\t\tconsole.log(data.comment);\r\n\t\t\t});\r\n\t\t\tthis.socket.on(\"recMedia\", function(data) {\r\n\t\t\t\tconsole.log(data.media);\r\n\r\n\t\t\t\tlet blob = new Blob([data.media], {\r\n\t\t\t\t\ttpye: \"video/x-matroska;codecs=avc1,opus\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, \"test : bitrate\" + this.bitrate);\r\n\t\t\t});\r\n\r\n\t\t\ttry {\r\n\t\t\t\tthis.cameraStream = await navigator.mediaDevices.getUserMedia(\r\n\t\t\t\t\tconstraints\r\n\t\t\t\t);\r\n\r\n\t\t\t\tthis.remoteStream1 = this.$refs[\"remoteStream1\"].captureStream();\r\n\t\t\t\tthis.remoteStream2 = this.$refs[\"remoteStream2\"].captureStream();\r\n\t\t\t\tthis.remoteStream3 = this.$refs[\"remoteStream3\"].captureStream();\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync timerRecord() {\r\n\t\t\tthis.startRecord();\r\n\t\t\tconst sleep = m => new Promise(r => setTimeout(r, m));\r\n\t\t\tawait sleep(10000);\r\n\t\t\tthis.stopRecord();\r\n\t\t},\r\n\t\t// async recordOneHour() {\r\n\t\t// \tthis.status = \"Recording\";\r\n\t\t// \tthis.chunkEnd = false;\r\n\t\t// \tthis.option.bitsPerSecond = this.bitrate;\r\n\t\t// \tthis.option.recorderType = this.recorderType;\r\n\r\n\t\t// \tthis.option.timeSlice = Number.parseInt(60000, 10);\r\n\t\t// \tthis.option.onTimeStamp = timestamp => {\r\n\t\t// \t\tconsole.log(timestamp);\r\n\t\t// \t};\r\n\r\n\t\t// \tthis.option.ondataavailable = blob => {\r\n\t\t// \t\tconsole.log(\"ondataavailable blob:: \", blob);\r\n\t\t// \t\tif (this.status === \"Stopped\") {\r\n\t\t// \t\t\tthis.chunkEnd = true;\r\n\t\t// \t\t}\r\n\t\t// \t\tthis.socket.emit(\"media_chunk\", {\r\n\t\t// \t\t\tchunkIndex: this.blobCount,\r\n\t\t// \t\t\tchunk: blob,\r\n\t\t// \t\t\tisEnd: this.chunkEnd\r\n\t\t// \t\t});\r\n\r\n\t\t// \t\tthis.blobCount++;\r\n\t\t// \t};\r\n\r\n\t\t// \tthis.recorder = new RecordRTC.RecordRTCPromisesHandler(\r\n\t\t// \t\tthis.stream,\r\n\t\t// \t\tthis.option\r\n\t\t// \t);\r\n\t\t// \tthis.recorder.startRecording();\r\n\r\n\t\t// \tconst sleep = m => new Promise(r => setTimeout(r, m));\r\n\t\t// \tawait sleep(3600000);\r\n\t\t// \tthis.stopRecord(null, true);\r\n\t\t// },\r\n\t\tsendMessage() {\r\n\t\t\tthis.socket.emit(\"msg\", { comment: \"hi\" });\r\n\t\t},\r\n\r\n\t\tsendClientMemoryStatus() {\r\n\t\t\tconst memory = window.performance.memory;\r\n\t\t\tthis.socket.emit(\"client_memory_stats\", {\r\n\t\t\t\tjsHeapSizeLimit: memory.jsHeapSizeLimit,\r\n\t\t\t\ttotalJSHeapSize: memory.totalJSHeapSize,\r\n\t\t\t\tusedJSHeapSize: memory.usedJSHeapSize\r\n\t\t\t});\r\n\t\t},\r\n\t\tsetRecordType($event, selectedRecordType) {\r\n\t\t\tconsole.log(selectedRecordType);\r\n\t\t\tswitch (selectedRecordType) {\r\n\t\t\t\tcase \"MediaStreamRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.MediaStreamRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"StereoAudioRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.StereoAudioRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"WebAssemblyRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.WebAssemblyRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"CanvasRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.CanvasRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"GifRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.GifRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"WhammyRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.WhammyRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"MultiStreamRecorder\":\r\n\t\t\t\t\tthis.recorderType = RecordRTC.MultiStreamRecorder;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tconsole.log(this.recorderType);\r\n\t\t},\r\n\t\tplay($event, refName) {\r\n\t\t\tthis.$refs[refName].play();\r\n\t\t},\r\n\t\tstop($event, refName) {\r\n\t\t\tthis.$refs[refName].pause();\r\n\t\t},\r\n\r\n\t\tstopMultiRecorder() {\r\n\t\t\tthis.status = \"Stopped\";\r\n\r\n\t\t\tthis.stop('','remoteStream1')\r\n\t\t\tthis.stop('','remoteStream2')\r\n\t\t\tthis.stop('','remoteStream3')\r\n\r\n\t\t\tconst stopCallback = this.getMultiRecorderStopCallBack(this.saveOpt);\r\n\r\n\t\t\tif (this.recLib === \"recordrtc\") {\r\n\t\t\t\tthis.multiRecorder.stop(stopCallback);\r\n\t\t\t} else if (this.recLib === \"msr\") {\r\n\t\t\t\tconsole.log(this.multiRecorder);\r\n\r\n\t\t\t\tthis.multiRecorder.stop();\r\n\t\t\t}\r\n\r\n\t\t\tthis.multiRecorder = null;\r\n\t\t},\r\n\r\n\t\tasync videoRecording($event, timeslice) {\r\n\t\t\tconsole.log(\"Record start videoRecording\");\r\n\r\n\t\t\tawait this.startRecorder(\"\", timeslice);\r\n\t\t},\r\n\t\tasync screenRecording($event, timeslice) {\r\n\t\t\tconsole.log(\"Record start screenRecording\");\r\n\r\n\t\t\tawait this.startRecorder(\"screen\", timeslice);\r\n\t\t},\r\n\r\n\t\tgetMultiRecorderStopCallBack(saveOpt) {\r\n\t\t\tlet stopCallback = () => {};\r\n\r\n\t\t\tif (saveOpt === \"file\") {\r\n\t\t\t\t//아무것도 하지 않음\r\n\t\t\t\treturn stopCallback;\r\n\t\t\t} else if (saveOpt === \"array\") {\r\n\t\t\t\tconsole.log(\"callback set array\");\r\n\t\t\t\tstopCallback = () => {\r\n\t\t\t\t\tconsole.log(\"stopCallback Called :: array\");\r\n\t\t\t\t\tif (this.chunkArray.length > 0) {\r\n\t\t\t\t\t\tvar blob = new File(this.chunkArray, this.fileName, {\r\n\t\t\t\t\t\t\ttype: this.mimeType\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconsole.log(\"chunkarray blobs::\", blob);\r\n\t\t\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, this.fileName + this.bitrate);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t} else if (saveOpt === \"idb\") {\r\n\t\t\t\tstopCallback = async () => {\r\n\t\t\t\t\t//indexed db에서 blob 불러옴\r\n\t\t\t\t\tconst queryResult = await IDBHelper.getMediaChunkArray(this.uuid);\r\n\t\t\t\t\tconst blobArray = [];\r\n\r\n\t\t\t\t\tqueryResult.forEach(record => {\r\n\t\t\t\t\t\tblobArray.push(record.blob);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar blob = new File(blobArray, this.fileName, {\r\n\t\t\t\t\t\ttype: this.mimeType\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, this.fileName);\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tstopCallback = blob => {\r\n\t\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, this.fileName);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn stopCallback;\r\n\t\t},\r\n\r\n\t\tgetOndataavailable(saveOpt) {\r\n\t\t\tlet ondataavailable = blob => {\r\n\t\t\t\tconsole.log(blob);\r\n\t\t\t};\r\n\r\n\t\t\tif (saveOpt === \"file\") {\r\n\t\t\t\tif (this.recLib === \"recordrtc\") {\r\n\t\t\t\t\tondataavailable = blob => {\r\n\t\t\t\t\t\tconsole.log(\"file\", blob);\r\n\t\t\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, this.fileName);\r\n\t\t\t\t\t\tthis.blobCount++;\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (this.recLib === \"msr\") {\r\n\t\t\t\t\tondataavailable = blob => {\r\n\t\t\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, this.fileName);\r\n\t\t\t\t\t\tthis.blobCount++;\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t} else if (saveOpt === \"array\") {\r\n\t\t\t\tondataavailable = blob => {\r\n\t\t\t\t\tconsole.log(\"array\", blob);\r\n\t\t\t\t\tthis.chunkArray.push(blob);\r\n\t\t\t\t\tthis.blobCount++;\r\n\t\t\t\t};\r\n\t\t\t} else if (saveOpt === \"idb\") {\r\n\t\t\t\tondataavailable = blob => {\r\n\t\t\t\t\tconsole.log(\"idb\", blob);\r\n\t\t\t\t\tIDBHelper.addMediaChunk(\r\n\t\t\t\t\t\tthis.uuid,\r\n\t\t\t\t\t\tthis.blobCount,\r\n\t\t\t\t\t\tthis.fileName,\r\n\t\t\t\t\t\tblob\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.blobCount++;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn ondataavailable;\r\n\t\t},\r\n\t\t/**\r\n\t\t * 스트림 배열을 리턴합니다.\r\n\t\t */\r\n\t\tgetStreamArray(recTarget) {\r\n\t\t\tconst streamArray = [];\r\n\r\n\t\t\tthis.remoteStream1 = this.$refs[\"remoteStream1\"].captureStream();\r\n\t\t\tthis.remoteStream2 = this.$refs[\"remoteStream2\"].captureStream();\r\n\t\t\tthis.remoteStream3 = this.$refs[\"remoteStream3\"].captureStream();\r\n\r\n\t\t\tconsole.log(this.remoteStream1.getAudioTracks());\r\n\t\t\tconsole.log(this.remoteStream2.getAudioTracks());\r\n\t\t\tconsole.log(this.remoteStream3.getAudioTracks());\r\n\r\n\t\t\tconst remoteAudioStream1 = new MediaStream();\r\n\t\t\tconst remoteAudioStream2 = new MediaStream();\r\n\t\t\tconst remoteAudioStream3 = new MediaStream();\r\n\r\n\t\t\tconst screenAudioStream = new MediaStream();\r\n\r\n\t\t\tremoteAudioStream1.addTrack(this.remoteStream1.getAudioTracks()[0]);\r\n\t\t\tremoteAudioStream2.addTrack(this.remoteStream2.getAudioTracks()[0]);\r\n\t\t\tremoteAudioStream3.addTrack(this.remoteStream3.getAudioTracks()[0]);\r\n\r\n\t\t\t//스크린 캡쳐는 오디오를 별도로 스트림에 추가해주어야한다.\r\n\t\t\t//스트린 캡쳐시 별도로 녹음이 안되기 때문\r\n\t\t\tscreenAudioStream.addTrack(this.cameraStream.getAudioTracks()[0]);\r\n\r\n\t\t\tif (recTarget === \"screen\") {\r\n\t\t\t\tstreamArray.push(this.screenStream);\r\n\t\t\t} else {\r\n\t\t\t\tstreamArray.push(this.cameraStream);\r\n\t\t\t}\r\n\r\n\t\t\tstreamArray.push(remoteAudioStream1);\r\n\t\t\tstreamArray.push(remoteAudioStream2);\r\n\t\t\tstreamArray.push(remoteAudioStream3);\r\n\r\n\t\t\tif (recTarget === \"screen\") {\r\n\t\t\t\tstreamArray.push(screenAudioStream);\r\n\t\t\t}\r\n\r\n\t\t\treturn streamArray;\r\n\t\t},\r\n\t\tasync setScreenCapture() {\r\n\t\t\tconst displayStream = await navigator.mediaDevices.getDisplayMedia({\r\n\t\t\t\tvideo:{\r\n\t\t\t\t\twidth: this.width,\r\n\t\t\t\t\theight: this.height,\r\n\t\t\t\t\tframeRate: 60\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.screenStream = displayStream;\r\n\t\t\tconsole.log(displayStream);\r\n\t\t},\r\n\t\tsetRecLib($event, lib) {\r\n\t\t\tthis.recLib = lib;\r\n\t\t},\r\n\t\tasync startRecorder(recTarget, timeslice) {\r\n\t\t\tthis.status = \"Recording\";\r\n\t\t\tthis.chunkArray = [];\r\n\r\n\t\t\tthis.play('','remoteStream1')\r\n\t\t\tthis.play('','remoteStream2')\r\n\t\t\tthis.play('','remoteStream3')\r\n\r\n\t\t\tconst option = {\r\n\t\t\t\tvideo: {\r\n\t\t\t\t\twidth: this.width,\r\n\t\t\t\t\theight: this.height\r\n\t\t\t\t},\r\n\t\t\t\tmimeType: this.mimeType,\r\n\t\t\t\tbitsPerSecond: this.bitrate\r\n\t\t\t};\r\n\r\n\t\t\tif (timeslice) {\r\n\t\t\t\tif (this.checkSaveOpt()) {\r\n\t\t\t\t\toption.ondataavailable = this.getOndataavailable(this.saveOpt);\r\n\t\t\t\t\toption.timeSlice = Number.parseInt(this.timeSliceValue, 10);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (recTarget === \"screen\") {\r\n\t\t\t\tawait this.setScreenCapture();\r\n\t\t\t} \r\n\r\n\t\t\tconst streamArray = this.getStreamArray(recTarget);\r\n\r\n\t\t\tswitch (this.recLib) {\r\n\t\t\t\tcase \"recordrtc\":\r\n\t\t\t\t\tthis.multiRecorder = new RecordRTC.MultiStreamRecorder(\r\n\t\t\t\t\t\tstreamArray,\r\n\t\t\t\t\t\toption\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.multiRecorder.record();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"msr\":\r\n\t\t\t\t\tthis.multiRecorder = new MSR.MultiStreamRecorder(streamArray, option);\r\n\t\t\t\t\tthis.multiRecorder.videoBitsPerSecond = this.bitrate;\r\n\t\t\t\t\tthis.multiRecorder.bitsPerSecond = this.bitrate;\r\n\t\t\t\t\tthis.multiRecorder.mimeType = this.mimeType;\r\n\r\n\t\t\t\t\tif (timeslice) {\r\n\t\t\t\t\t\tthis.multiRecorder.ondataavailable = this.getOndataavailable(\r\n\t\t\t\t\t\t\tthis.saveOpt\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst stopCallback = this.getMultiRecorderStopCallBack(\r\n\t\t\t\t\t\t\tthis.saveOpt\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.multiRecorder.onstop = stopCallback;\r\n\t\t\t\t\t\tthis.multiRecorder.start(Number.parseInt(this.timeSliceValue, 10));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//msr은 stop() 호출시 ondataavailable가 호출된다.\r\n\t\t\t\t\t\t//bug!! msr은 현재 stop 호출하면 ondataavailable이 두번 호출됨\r\n\t\t\t\t\t\tthis.multiRecorder.ondataavailable = blob => {\r\n\t\t\t\t\t\t\t//RecordRTC.invokeSaveAsDialog(blob, this.fileName);\r\n\t\t\t\t\t\t\tthis.chunkArray.push(blob);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.multiRecorder.onstop = () => {\r\n\t\t\t\t\t\t\tvar blob = new File(this.chunkArray, this.fileName, {\r\n\t\t\t\t\t\t\t\ttype: this.mimeType\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tRecordRTC.invokeSaveAsDialog(blob, this.fileName);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.multiRecorder.start();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log(\"wrong rec lib\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tconsole.log(this.multiRecorder);\r\n\t\t},\r\n\t\tcheckSaveOpt() {\r\n\t\t\tif (this.saveOpt === \"\") {\r\n\t\t\t\talert(\"Save Option을 먼저 지정해주세요\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoggleWorkerVideo() {\r\n\t\t\tconst videoTrack = this.cameraStream.getVideoTracks()[0];\r\n\t\t\tvideoTrack.enabled = !videoTrack.enabled;\r\n\t\t\tthis.workerVideoStatus = videoTrack.enabled;\r\n\t\t},\r\n\t\ttoggleWorkerSound() {\r\n\t\t\tconst audioTrack = this.cameraStream.getAudioTracks()[0];\r\n\t\t\taudioTrack.enabled = !audioTrack.enabled;\r\n\t\t\tthis.workerAudioStatus = audioTrack.enabled;\r\n\t\t},\r\n\t\ttoggleRemoteVideo($event, refName) {\r\n\t\t\tlet videoTrack = null;\r\n\t\t\tswitch (refName) {\r\n\t\t\t\tcase \"remoteStream1\":\r\n\t\t\t\t\tvideoTrack = this.remoteStream1.getVideoTracks()[0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"remoteStream2\":\r\n\t\t\t\t\tvideoTrack = this.remoteStream2.getVideoTracks()[0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"remoteStream3\":\r\n\t\t\t\t\tvideoTrack = this.remoteStream3.getVideoTracks()[0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log(\"Wrong refName\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tvideoTrack.enabled = !videoTrack.enabled;\r\n\t\t\tconsole.log(refName + \" videoTrack ::\" + videoTrack.enabled);\r\n\t\t},\r\n\t\ttoggleRemoteSound($event, refName) {\r\n\t\t\tlet audioTrack = null;\r\n\t\t\tthis.$refs[refName].muted = !this.$refs[refName].muted;\r\n\r\n\t\t\t//현 시점에서는 필요 없는 코드\r\n\t\t\tswitch (refName) {\r\n\t\t\t\tcase \"remoteStream1\":\r\n\t\t\t\t\taudioTrack = this.remoteStream1.getAudioTracks()[0];\r\n\t\t\t\t\tthis.remote1AudioStatus = !this.$refs[refName].muted;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"remoteStream2\":\r\n\t\t\t\t\taudioTrack = this.remoteStream2.getAudioTracks()[0];\r\n\t\t\t\t\tthis.remote2AudioStatus = !this.$refs[refName].muted;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"remoteStream3\":\r\n\t\t\t\t\taudioTrack = this.remoteStream3.getAudioTracks()[0];\r\n\t\t\t\t\tthis.remote3AudioStatus = !this.$refs[refName].muted;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log(\"Wrong refName\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\taudioTrack.enabled = !audioTrack.enabled;\r\n\r\n\t\t\tconsole.log(refName + \" audioTrack ::\" + audioTrack.enabled);\r\n\t\t\tconsole.log(refName + \" audioTrack muted ::\" + this.$refs[refName].muted);\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tthis.init();\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.wrapper {\r\n\tdisplay: flex;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BitRateTest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BitRateTest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BitRateTest.vue?vue&type=template&id=3e9a83a5&\"\nimport script from \"./BitRateTest.vue?vue&type=script&lang=js&\"\nexport * from \"./BitRateTest.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BitRateTest.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <BitRateTest msg=\"Welcome to Your Vue.js App\"/>\n  </div>\n</template>\n\n<script>\nimport BitRateTest from './components/BitRateTest.vue'\n\nexport default {\n  name: 'App',\n  components: {\n    BitRateTest\n  }\n}\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=5e80ff8c&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BitRateTest.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BitRateTest.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}